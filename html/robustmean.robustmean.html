
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module robustmean.robustmean</title>
<meta name="description" content="Documentation of Coq module robustmean.robustmean" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module robustmean.robustmean</h1>
<div class="coq">
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html">ssralg</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html">ssrnum</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.matrix.html">matrix</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct">Rstruct</a></span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.reals">reals</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.micromega.Lra.html">Lra</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR">ssrR</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.Reals_ext">Reals_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.realType_ext">realType_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.logb">logb</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext">ssr_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssralg_ext">ssralg_ext</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.bigop_ext">bigop_ext</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist">fdist</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba">proba</a></span>.<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">R_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">reals_ext_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">fdist_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">proba_scope</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory">Order.POrderTheory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Theory">Order.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory">Num.Theory</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory">GRing.Theory</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="R" class="id"><a name="R" class="">R</a></span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#real_realType">real_realType</a></span>.<br/>
<br/>
<div class="ssrdoc md">
# resilience, robustmean                                                   
                                                                           
|Definitions  |    | Meaning                                              |
|-------------|----|------------------------------------------------------|
|    X `* Y   | == | multiplication of random variables                    
| `V_[X \| F] | == | conditional variance                                  
| ...         | == | ...                                                   
                                                                           
</div>
<br/>
<span class="vernacular">Definition</span> <span class="id">mul_RV</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>) (<span class="id">X</span> <span class="id">Y</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span id="C:8" class="id"><a name="C:8" class="">-&gt;</a></span> <span class="id">R}</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">X</a></span> <span class="id">x</span> <span class="id"><a href="robustmean.robustmean.html#C:8">*</a></span> <span class="id">Y</span> <span class="id">x</span>.<br/>
<span class="vernacular">Notation</span> <span class="id"><a href="robustmean.robustmean.html#C:8">&quot;X `* Y&quot;</a></span> <span class="id">:=</span> (<span class="id">mul_RV</span> <span class="id">X</span> <span class="id">Y</span>) <span class="id">:</span> <span class="id">proba_scope</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">mul_RV</span> <span class="id">/</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="e9dfdac6fe6c5efcff25f3032b770ed8" class="id"><a name="e9dfdac6fe6c5efcff25f3032b770ed8" class="">conj_intro_pattern</a></span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">and_curry</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">:</span> <span class="gallina-kwd">Prop</span>) <span class="id">:</span> (<span class="id">A</span> <span class="id">/\</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">C</span>) <span class="id">-&gt;</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">C</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="id">move=&gt;</span> <span class="id">+</span> <span class="id">a</span> <span class="id">b;</span> <span class="id">exact</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">conj_intro_pattern</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;[conj]&quot;</span> <span class="id">:=</span> (<span class="id">ltac:</span>(<span class="id">apply</span> <span class="id">and_curry</span>)) (<span class="id">only</span> <span class="id">parsing</span>) <span class="id">:</span> <span class="id">ssripat_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">RV_ring</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>).<br/>
<br/>
<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">fdist_supp_choice</span> <span class="id">:</span> <span class="id">U</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="gallina-kwd">by</span> <span class="id">move/set0Pn/xchoose:</span>(<span class="id">fdist_supp_neq0</span> <span class="id">P</span>).<br/>
Defined.</div>
<br/>
<br/>
<br/>
<br/>
<span class="vernacular">End</span> <span class="id">RV_ring</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">sets_functions</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">set1I</span> (<span class="id">X:finType</span>) (<span class="id">x:X</span>) (<span class="id">A:{set</span> <span class="id">X}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">[set</span> <span class="id">x]</span> <span class="id">:&amp;:</span> <span class="id">A</span> <span class="id">=</span> <span class="gallina-kwd">if</span> <span class="id">x</span> <span class="id">\in</span> <span class="id">A</span> <span class="gallina-kwd">then</span> <span class="id">[set</span> <span class="id">x]</span> <span class="gallina-kwd">else</span> <span class="id">set0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/setIidPl;</span> <span class="id">rewrite</span> <span class="id">sub1set</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/disjoint_setI0;</span> <span class="id">rewrite</span> <span class="id">disjoints1</span> <span class="id">H0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">in_preim1</span> (<span class="id">A:finType</span>) (<span class="id">B:eqType</span>) (<span class="id">a:A</span>) (<span class="id">b:B</span>) <span class="id">X</span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">a</span> <span class="id">\in</span> <span class="id">finset</span> (<span class="id">T:=A</span>) (<span class="id">preim</span> <span id="Ind_subset" class="id"><a name="Ind_subset" class="">X</a></span> (<span class="id">pred1</span> <span class="id">b</span>))) <span class="id">-&gt;</span> <span class="id">X</span> <span class="id">a</span> <span class="id">=</span> <span class="id">b</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">in_set</span> <span class="id">=&gt;</span> <span class="id">/eqP</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">in_preim1'</span> (<span class="id">A:finType</span>) (<span class="id">B:eqType</span>) (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">a:A</a></span>) (<span class="id">b:B</span>) <span class="id">X</span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">a</span> <span class="id">\in</span> <span class="id">finset</span> (<span class="id">T:=A</span>) (<span class="id">preim</span> <span class="id">X</span> (<span class="id">pred1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#subsetP">b</a></span>))) <span class="id">=</span> (<span class="id">X</span> <span class="id">a</span> <span class="id">==</span> <span class="id">b</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">apply/idP;</span> <span class="id">case</span> <span class="id">H:</span> (<span class="id">X</span> <span class="id">a</span> <span class="id">==</span> <span class="id">b</span>)<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move/eqP:</span> <span class="id">H</span> <span class="id">&lt;-;</span> <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">/=</span> <span class="id">eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">H=&gt;</span> <span class="id">/[swap]</span> <span class="id">/in_preim1</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">eqxx</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ind_subset</span> (<span class="id"><a href="robustmean.robustmean.html#sets_functions">A</a></span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">X</span> <span class="id">Y</span> <span class="id">:</span> <span class="id">{set</span> <span id="probability" class="id"><a name="probability" class="">A}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">X</span> <span class="id">\subset</span> <span class="id">Y</span> <span class="id">&lt;-&gt;</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">Ind</span> <span id="probability.P" class="id"><a name="probability.P" class="">X</a></span> <span class="id">a</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">&lt;=</a></span> <span class="id">Ind</span> <span class="id"><a href="robustmean.robustmean.html#U:28">Y</a></span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span id="sq_RVE" class="id"><a name="sq_RVE" class="">rewrite</a></span> <span id="X:30" class="id"><a name="X:30" class="">/Ind;</a></span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">move=&gt;</a></span> <span class="id"><a href="robustmean.robustmean.html#X:30">a;</a></span> <span class="id">case:</span> <span class="id">ifPn</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move/</span>(<span class="id">subsetP</span> <span class="id">H</span>) <span class="id">-&gt;;</span> <span class="id">apply/RleP</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> (<span class="id">a</span> <span class="id">\in</span> <span class="id">Y</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">=&gt;</a></span> <span class="id">_</span> <span class="id">//;</span> <span class="id">apply/RleP</span>.<br/>
<span class="id">apply/subsetP</span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">a</a></span> <span class="id">aX</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move:</span> (<span class="id">H</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">a</a></span>)<span class="id">;</span> <span class="id"><a href="robustmean.robustmean.html#X:31">rewrite</a></span> <span class="id">aX;</span> <span class="id">case:</span> (<span class="id">a</span> <span class="id">\in</span> <span class="id">Y</span>) <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">move/RleP;</a></span> <span class="id">rewrite</span> <span class="id">ler10</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">sets_functions</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">probability</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">:</a></span> <span class="id">finType</span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">P</a></span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">{fdist</a></span> <span class="id">U}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">sq_RVE</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">X</a></span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">:</span> <span class="id">X</span> <span class="id">`^2</span> <span class="id">=</span> <span class="id">X</span> <span class="id">`*</span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_RV/comp_RV/=;</span> <span class="id">apply:</span> <span class="id">boolp.funext</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">mulR1</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ind_ge0</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">X</a></span> <span class="id">:</span> <span class="id">{set</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">U}</a></span>) (<span class="id">x</span> <span class="id">:</span> <span class="id">U</span>) <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">Ind</span> <span class="id">X</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/Ind;</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">//</a></span> <span class="id">_;</span> <span class="id">apply</span> <span class="id">Rle_refl</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ind_setD</span> (<span class="id">X</span> <span class="id">Y</span> <span class="id">:</span> <span class="id">{set</span> <span class="id">U}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">Y</span> <span class="id">\subset</span> <span class="id">X</span> <span class="id">-&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">Ind</a></span> (<span class="id">X</span> <span class="id">:\:</span> <span class="id">Y</span>) <span class="id">=</span> <span class="id">Ind</span> <span class="id">X</span> <span class="id">`-</span> <span class="id">Ind</span> <span class="id">Y</span> <span class="id">:&gt;</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">move/subsetP=&gt;</span> <span class="id">YsubX;</span> <span class="id">rewrite</span> <span class="id">/Ind</span> <span class="id">/sub_RV</span>. <span class="id">apply</span> <span class="id">boolp.funext</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">/=</span>.<br/>
<span class="id">case:</span> <span class="id">ifPn;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">rewrite</a></span> <span class="id">inE</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">?negb_and;</a></span><br/>
&nbsp;&nbsp;<span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">case/andP</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#cEx">=&gt;</a></span> <span class="id">/negbTE</span> <span class="id">-&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">subR0</span>.<br/>
<span class="id">case/orP;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">/negbNE</span> <span class="id">/[dup]</span> <span class="id">/YsubX</span> <span class="id">-&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">subRR</span>.<br/>
<span class="id">move/contraNN:</span> (<span class="id">YsubX</span> <span class="id">u</span>) <span class="id">=&gt;</span> <span class="id">YsubX'</span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">move=&gt;</a></span> <span id="i0:41" class="id"><span id="i0:40" class="id"><span id="i0:39" class="id"><span id="i0:38" class="id"><span id="i0:37" class="id"><a name="i0:41" class="">/[dup]</a></span></span></span></span></span> <span class="id">/YsubX'</span> <span class="id">/negbTE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#pred1">-&gt;</a></span> <span class="id">/negbTE</span> <span class="id">-&gt;</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">rewrite</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">subRR</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#finset">cEx_ExInd</a></span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">`E_[X</span> <span class="id">|</span> <span class="id"><a href="robustmean.robustmean.html#i0:42">F]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=</a></span> <span class="id">`E</span> (<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#probability.U">`*</a></span> <span class="id"><a href="robustmean.robustmean.html#i0:42">Ind</a></span> (<span class="id"><a href="robustmean.robustmean.html#probability.P">A:=U</a></span>) <span class="id">F</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id">/cEx</span> <span class="comment">(*&nbsp;need&nbsp;some&nbsp;lemmas&nbsp;to&nbsp;avoid&nbsp;unfolds&nbsp;*)</span> <span class="id">-big_distrl</span> <span class="id">/=</span>.<br/>
<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mulr1">apply:</a></span> <span class="id">congr2</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#finset">=&gt;</a></span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_distrr</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">have</a></span> <span class="id"><a href="robustmean.robustmean.html#i0:47">-&gt;</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id"><a href="robustmean.robustmean.html#probability.P">i0</a></span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id">preim</span> <span class="id">X</span> (<span class="id">pred1</span> <span class="id">i</span>)) <span class="id">:&amp;:</span> <span class="id">F</span>) (<span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i0</span>) <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i0</span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id">preim</span> <span class="id">X</span> (<span class="id">pred1</span> <span class="id">i</span>)) <span class="id">:&amp;:</span> <span class="id">F</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> <span class="id">i0</span> <span class="id">*</span> <span class="id">@Ind</span> <span class="id">U</span> <span class="id">F</span> <span class="id">i0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">*</a></span> <span class="id">P</span> <span class="id">i0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">congr_big</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">=&gt;</a></span> <span class="id">//</span> <span class="id">i0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">in_setI</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssralg.html#GRing.Theory.mul0r">/Ind</a></span> <span class="id">=&gt;</span> <span class="id">/andP[]</span> <span class="id">/in_preim1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">-&gt;</a></span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#pred1">!coqRE</a></span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">H1</span> <span class="id"><a href="robustmean.robustmean.html#i0:52">:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#i0:52">\sum_</a></span>(<span class="id">i0</span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id">preim</span> <span class="id">X</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#preim">pred1</a></span> <span class="id">i</span>)) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#pred1">:\:</a></span> <span class="id">F</span>) <span class="id">X</span> <span class="id">i0</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">Ind</a></span> <span class="id"><a href="robustmean.robustmean.html#i0:57">F</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">i0</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">*</a></span> <span class="id">P</span> <span class="id">i0</span> <span class="id"><a href="robustmean.robustmean.html#i0:57">=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;should&nbsp;be&nbsp;true&nbsp;because&nbsp;all&nbsp;elements&nbsp;of&nbsp;the&nbsp;sum&nbsp;are&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big1</span> <span class="id">//</span> <span class="id">=&gt;</span> <span class="id">i1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">in_setD</span> <span class="id">=&gt;</span> <span class="id">/andP</span> <span class="id">[H2</span> <span class="id">H3]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id">/Ind</span> (<span class="id">negbTE</span> <span class="id">H2</span>) <span class="id">mulr0</span> <span class="id">mul0r</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i0</span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id">preim</span> <span class="id">X</span> (<span class="id">pred1</span> <span class="id">i</span>))) <span class="id">X</span> <span class="id">i0</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">Ind</a></span> <span class="id"><a href="robustmean.robustmean.html#probability.P">F</a></span> <span class="id">i0</span> <span class="id"><a href="robustmean.robustmean.html#R">*</a></span> <span class="id">P</span> <span id="F:68" class="id"><a name="F:68" class="">i0</a></span> <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">\sum_</a></span>(<span class="id">i0</span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id"><a href="robustmean.robustmean.html#F:68">preim</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">X</a></span> (<span class="id"><a href="robustmean.robustmean.html#probability.P">pred1</a></span> <span class="id">i</span>)) <span class="id"><a href="robustmean.robustmean.html#probability.P">:&amp;:</a></span> <span class="id">F</span>) <span class="id">X</span> <span class="id">i0</span> <span class="id">*</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#cEx_ExInd">i0</a></span> <span class="id">*</span> <span class="id">P</span> <span class="id">i0</span> <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i0</span> <span class="gallina-kwd">in</span> <span class="id">finset</span> (<span class="id">preim</span> <span class="id">X</span> (<span class="id">pred1</span> <span class="id">i</span>)) <span class="id">:\:</span> <span class="id">F</span>) <span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">i0</a></span> <span class="id">*</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">i0</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">big_setID</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">H1</a></span> <span class="id">addr0</span> <span class="id">=&gt;</span> <span class="id">&lt;-</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">eq_bigl</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">in_preim1'</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">over</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-partition_big_fin_img</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">cExE</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#682c1486174cfd51fb2b3db1653efd0c">X</a></span> <span class="id">:</span> <span class="id">{RV</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#b58ab32fcbd4640d180ac9af8cade987">P</a></span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#682c1486174cfd51fb2b3db1653efd0c">R}</a></span>) <span class="id">F</span> <span class="id">:</span> <span class="id"><a href="robustmean.robustmean.html#Y:77">`E_[X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">|</a></span> <span class="id">F]</span> <span class="id"><a href="robustmean.robustmean.html#a:74">=</a></span> (<span class="id">\sum_</span>(<span class="id">u</span> <span class="gallina-kwd">in</span> <span class="id">F</span>) <span class="id">X</span> <span class="id">u</span> <span class="id"><a href="robustmean.robustmean.html#b:75">*</a></span> <span class="id">P</span> <span class="id"><a href="robustmean.robustmean.html#b:75">u</a></span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id"><a href="robustmean.robustmean.html#Y:77">P</a></span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">rewrite</span> <span class="id">cEx_ExInd</span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">congr</a></span> (<span class="id">_</span> <span class="id">/</span> <span class="id"><a href="robustmean.robustmean.html#R">_</a></span>).<br/>
<span class="id">rewrite</span> <span class="id">/Ex</span> <span class="id">/ambient_dist</span> <span class="id">/Ind</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">/mul_RV</a></span> <span class="id">2!fun_if</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#682c1486174cfd51fb2b3db1653efd0c">if_arg</a></span> <span class="id">mulR0</span> <span class="id">mul0R</span> <span class="id">mulR1</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#b58ab32fcbd4640d180ac9af8cade987">[in</a></span> <span class="id">RHS]big_mkcond</span> <span class="id">/=</span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">exact:</a></span> <span class="id">eq_bigr</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ex_square_expansion</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">X</span> <span class="id">Y</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#ambient_dist">`E</a></span> ((<span class="id">a</span> <span class="id">`cst*</span> <span class="id">X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#scalel_RV">`+</a></span> <span class="id">b</span> <span class="id">`cst*</span> <span class="id">Y</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV">`^2</a></span>) <span class="id">=</span><br/>
&nbsp;&nbsp;<span class="id">a</span> <span class="id">*</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rpow_def.html#pow">a</a></span> <span class="id">*</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>) <span class="id">+</span> <span class="id">b</span> <span class="id">*</span> <span class="id">b</span> <span class="id">*</span> <span class="id">`E</span> (<span class="id">Y</span> <span class="id">`^2</span>) <span class="id">+</span> <span class="id">2</span> <span class="id">*</span> <span id="X:78" class="id"><a name="X:78" class="">a</a></span> <span class="id">*</span> <span class="id">b</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x">*</a></span> <span class="id">`E</span> (<span class="id">X</span> <span id="x:79" class="id"><a name="x:79" class="">`*</a></span> <span class="id"><a href="robustmean.robustmean.html#X:78">Y:{RV</a></span> <span class="id">P</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">-&gt;</a></span> <span class="id"><a href="robustmean.robustmean.html#probability.P">R}</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">suff</span> <span class="id"><a href="robustmean.robustmean.html#X:78">:</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">`E</a></span> ((<span class="id">a</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">`cst*</a></span> <span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#R">`+</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">b</a></span> <span class="id">`cst*</span> <span class="id">Y</span>) <span class="id">`^2</span>) <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`E</span> ((<span class="id">a</span> <span class="id">*</span> <span class="id">a</span>) <span class="id">`cst*</span> (<span class="id">X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big1">`^2</a></span>) <span class="id">`+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b</span> <span class="id">*</span> <span class="id">b</span>) <span class="id">`cst*</span> (<span class="id">Y</span> <span class="id">`^2</span>) <span class="id">`+</span> (<span class="id">2</span> <span class="id">*</span> <span class="id">a</span> <span class="id">*</span> <span class="id">b</span>) <span class="id">`cst*</span> (<span class="id">X</span> <span class="id">`*</span> <span class="id">Y</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV">rewrite</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#comp_RV">!E_add_RV</a></span> <span class="id">!E_scalel_RV</span>.<br/>
<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">H</span>.<br/>
<span class="id">unfold</span> <span class="id">ambient_dist,</span> <span class="id">&quot;`cst*&quot;, &quot;`+&quot;, &quot;`^2&quot;, &quot;`o&quot;, &quot;^&quot;, &quot;`*&quot;</span>.<br/>
<span class="id">nra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ex_square_eq0</span> <span class="id">X</span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span class="id">x,</span> <span class="id">X</span> <span class="id">x</span> <span class="id">=</span> <span class="id">0</span> <span class="id">\/</span> <span class="id">P</span> <span class="id">x</span> <span class="id">=</span> <span class="id">0</span>) <span class="id">&lt;-&gt;</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">P</a></span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">=</span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">split=&gt;</span> <span class="id">[XP|EX20]</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">/Ex</span> <span class="id">big1//</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[|-&gt;]</span> <span class="id">:=</span> <span class="id">XP</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_eq0">u;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulR0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_RV</span> <span class="id">/comp_RV</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_eq0">!mul0R</a></span>.<br/>
<span class="id">-</span> <span class="id">have</span> <span class="id">XP</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x,</span> <span class="id">x</span> <span class="id">\in</span> <span class="id">U</span> <span class="id">-&gt;</span> (<span class="id">X</span> <span class="id">`^2:</span> <span class="id">{RV</span> <span class="id">P</span> <span id="X:81" class="id"><a name="X:81" class="">-&gt;</a></span> <span class="id">R}</span>) <span class="id">x</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">P</a></span> <span class="id">x</span> <span class="id"><a href="robustmean.robustmean.html#R">=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">Ux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">apply:</a></span> (<span class="id">psumr_eq0P</span> <span class="id">_</span> <span class="id"><a href="robustmean.robustmean.html#X:81">EX20</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=&gt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">//</a></span> <span class="id">i</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">Ui</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulr_ge0//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/RleP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">sq_RV_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">XP</a></span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ex_ge0">inE</a></span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">erefl</span>) <span class="id">/mulR_eq0[|-&gt;];</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ex_ge0">/sq_RV</a></span> <span class="id">/comp_RV</span> <span class="id">/=</span> <span class="id">mulR1</span> <span class="id">=&gt;</span> <span class="id">/mulR_eq0[|]</span> <span class="id">-&gt;;</span> <span class="id">left</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Cauchy_Schwarz_proba</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">X</a></span> <span class="id">Y</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">:</a></span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">Rsqr</span> (<span class="id">`E</span> (<span class="id">X</span> <span class="id">`*</span> <span class="id">Y</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">:</a></span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>)) <span class="id">&lt;=</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>) <span class="id">*</span> <span class="id">`E</span> (<span class="id">Y</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">`^2</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">pose</span> <span class="id">a</span> <span class="id">:=</span> <span class="id">sqrt</span> (<span class="id">`E</span> (<span class="id">Y</span> <span class="id">`^2</span>)).<br/>
<span class="id">pose</span> <span class="id">b</span> <span class="id">:=</span> <span class="id">sqrt</span> (<span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>)).<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>) <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">Ex_ge0;</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">:</a></span> <span class="id">0</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">`E</a></span> (<span class="id">Y</span> <span class="id">`^2</span>) <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">Ex_ge0;</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
<span class="id">have</span> <span class="id">H2ab</span> <span class="id">:</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">2</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">*</a></span> <span class="id">a</span> <span class="id"><a href="robustmean.robustmean.html#R">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">b</a></span> <span class="id">*</span> (<span class="id">b</span> <span class="id">*</span> <span class="id">a</span>) <span class="id">=</span> <span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqP">*</a></span> <span class="id">a</span> <span class="id">*</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.psumr_eq0">+</a></span> <span class="id">b</span> <span class="id">*</span> <span class="id">b</span> <span class="id">*</span> <span class="id">`E</span> (<span class="id">Y</span> <span class="id">`^2</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">Rsqr_sqrt</span> (<span class="id">`E</span> (<span class="id">X</span> <span class="id">`^2</span>)))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">Rsqr_sqrt</span> (<span class="id">`E</span> (<span class="id">Y</span> <span class="id">`^2</span>)))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-/a</span> <span class="id">-/b</span> <span class="id">/Rsqr;</span> <span class="id">nra</span>.<br/>
<span class="id">have</span> <span class="id">[a0|a0]</span> <span class="id">:=</span> <span class="id">Req_dec</span> <span class="id">a</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sqrt_eq_0</span> <span class="gallina-kwd">in</span> <span class="id">a0</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">HY</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">y,</span> <span class="id">Y</span> <span class="id">y</span> <span class="id">=</span> <span class="id">0</span> <span class="id">\/</span> <span class="id">P</span> <span class="id">y</span> <span class="id">=</span> <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">apply/Ex_square_eq0/a0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`*</span> <span class="id">Y:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_eq_0">R}</a></span>) <span class="id">=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/eqP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">psumr_eq0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/allP</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case</span> <span class="id">:</span> (<span class="id">HY</span> <span class="id">u</span>) <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">-&gt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">;</a></span> <span class="id">rewrite</span> <span class="id">mulR0</span> <span class="id">?mul0R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="robustmean.robustmean.html#mul_RV">.</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case</span> <span class="id">:</span> (<span class="id">HY</span> <span class="id">u</span>) <span class="id">=&gt;</span> <span class="id">-&gt;</span> <span class="id">;</span> <span class="id">rewrite</span> <span class="id">mulR0</span> <span class="id">?mul0R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Rsqr_0;</span> <span class="id">apply/mulR_ge0</span>.<br/>
<span class="id">have</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#allP">[b0|b0]</a></span> <span class="id">:=</span> <span class="id">Req_dec</span> <span class="id">b</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">0</a></span>. <span class="comment">(*&nbsp;todo:&nbsp;replace&nbsp;with&nbsp;eqVneq..&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR0">sqrt_eq_0</a></span> <span class="gallina-kwd">in</span> <span class="id">b0</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">HX</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x,</span> <span class="id">X</span> <span class="id">x</span> <span class="id">=</span> <span class="id">0</span> <span class="id">\/</span> <span class="id">P</span> <span class="id">x</span> <span class="id">=</span> <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">/Ex_square_eq0/b0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">`E</span> (<span class="id">X</span> <span class="id">`*</span> <span class="id">Y:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/eqP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">psumr_eq0</a></span> <span class="id">/mul_RV;</span> <span class="id">last</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">first</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_neqAle">move=&gt;</a></span> <span class="id">u</span> <span class="id">_;</span> <span class="id">case</span> <span class="id">:</span> (<span class="id">HX</span> <span class="id">u</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#nesym">=&gt;</a></span> <span class="id">-&gt;</span> <span class="id">;</span> <span class="id">rewrite</span> <span class="id">?mulR0</span> <span class="id">?mul0R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/allP</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=&gt;</a></span> <span class="id">u</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">inE/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case</span> <span class="id">:</span> (<span class="id">HX</span> <span class="id">u</span>) <span class="id">=&gt;</span> <span class="id">-&gt;</span> <span class="id">;</span> <span class="id">rewrite</span> <span class="id">?mulR0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#neg_pos_Rsqr_le">?mul0R</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Rsqr_0;</span> <span class="id">apply/mulR_ge0</span>.<br/>
<span class="id">have</span> <span class="id">{}a0</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">a</span> <span class="comment">(*removes&nbsp;a0&nbsp;hypothesis&nbsp;and&nbsp;reuse&nbsp;it*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/ltR_neqAle;</span> <span class="id">split;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulNR">[exact/nesym|exact/sqrt_pos]</a></span>.<br/>
<span class="id">have</span> <span class="id">{}b0</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">&lt;</a></span> <span class="id">b</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/ltR_neqAle;</span> <span class="id">split;</span> <span class="id">[exact/nesym|exact/sqrt_pos]</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">Rsqr_sqrt</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">sqrt_mult//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_gt0">-/a</a></span> <span class="id">-/b</span>.<br/>
<span class="id">apply:</span> <span class="id">neg_pos_Rsqr_le</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id">@leR_pmul2r</span> (<span class="id">2</span> <span class="id">*</span> <span class="id">a</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR_opp">b</a></span>))<span class="id">;</span> <span class="id">last</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulNR">first</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">mulR_gt0</span> <span class="id"><a href="robustmean.robustmean.html#Ex_square_expansion">=&gt;</a></span> <span class="id">//;</span> <span class="id">apply</span> <span class="id">mulR_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-subR_ge0</span> <span class="id">mulNR</span> <span class="id">subR_opp</span> <span class="id">addRC</span> <span class="id">mulRC</span> <span class="id">H2ab</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">rewrite</a></span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">mulRC</a></span> (<span class="id">`E</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">X</a></span> <span class="id">`*</span> <span class="id">Y</span>))) <span class="id">-Ex_square_expansion</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">Ex_ge0;</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
<span class="id">-</span> <span class="id">apply/</span>(<span class="id">@leR_pmul2l</span> (<span class="id">2</span> <span class="id">*</span> <span class="id">a</span> <span class="id">*</span> <span class="id">b</span>))<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">do</span> <span class="id">2</span> <span class="id">apply:</span> <span class="id">mulR_gt0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">=&gt;</a></span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/subR_ge0;</span> <span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">rewrite</a></span> <span class="id">H2ab</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">-</a></span>(<span class="id">Rmult_opp_opp</span> <span class="id">b</span>) <span class="id">-addR_opp</span> <span class="id">-mulNR</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">-mulRN</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Ex_square_expansion;</span> <span class="id">apply:</span> <span class="id">Ex_ge0;</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">I_square</span> <span class="id">F</span> <span class="id">:</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">=</span> ((<span class="id">Ind</span> <span class="id">F</span>) <span class="id">`^2</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">rewrite</span> <span class="id">sq_RVE</span> <span class="id">boolp.funeqE</span> <span class="id">/Ind</span> <span class="id">/mul_RV</span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">?mulR0</a></span> <span class="id">?mulR1</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">I_double</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{set</span> <span class="id">U}</span>) <span class="id"><a href="robustmean.robustmean.html#m:88">:</a></span> <span class="id">Ind</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">F</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id">Ind</span> <span class="id"><a href="robustmean.robustmean.html#X:87">F</a></span>) <span class="id">`*</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">Ind</a></span> <span class="id">F</span>) <span class="id">:&gt;</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[LHS]I_square</span> <span class="id">sq_RVE</span>. Qed.</div>
<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">cEx_trans_min_RV</a></span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">m</span> <span class="id">F</span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#X:90">!=</a></span> <span class="id">0</span> <span class="id"><a href="robustmean.robustmean.html#F:91">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[</a></span> (<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#G:92">`-cst</a></span> <span class="id">m</span>) <span class="id">|</span> <span class="id">F]</span> <span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">=</a></span> <span class="id"><a href="robustmean.robustmean.html#X:90">`E_[</a></span> <span class="id">X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">|</a></span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#X:90">]</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-</a></span> <span class="id"><a href="robustmean.robustmean.html#G:92">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">move=&gt;</span> <span class="id">PF0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">!cExE</a></span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#F:91">under</a></span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_gt0">/trans_min_RV</a></span> <span class="id">mulRDl</span>.<br/>
<span class="id">rewrite</span> <span class="id">big_split/=</span> <span class="id">divRDl;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">+</a></span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-big_distrr/=</span> <span class="id">-Rmult_div_assoc</span> <span class="id">divRR</span> <span class="id">?mulR1</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_sub</span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">F</span> <span class="id">G:</span> <span class="id">{set</span> <span class="id">U}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span id="X:93" class="id"><a name="X:93" class="">&lt;</a></span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">F</a></span> <span class="id">\subset</span> <span class="id">G</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`|</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d1cce020b4b43370087fd70de1477ab6">`E_[</a></span> <span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#probability.U">|</a></span> <span class="id">F</span> <span class="id">]</span> <span class="id">-</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]</span> <span class="id">|</span><br/>
<span class="id">=</span> <span class="id">`|</span> <span class="id">`E</span> ((<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">X</a></span> <span class="id">`-cst</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setIT">`*</a></span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#pr_eqE">R}</a></span>) <span class="id">|</span> <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">move=&gt;</span> <span class="id">/[dup]</span> <span class="id">/Pr_gt0</span> <span class="id">PrPF_neq0</span> <span class="id">/invR_gt0</span> <span class="id">/ltRW</span> <span class="id">PrPFV_ge0</span> <span class="id">FsubG</span>.<br/>
<span class="id">rewrite</span> <span class="id">divRE</span> <span class="id">-</span>(<span class="id">geR0_norm</span> (<span class="id">/Pr</span> <span class="id">P</span> <span class="id">F</span>)) <span class="id">//</span> <span class="id">-normRM</span>.<br/>
<span class="id">apply:</span> <span class="id">congr1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-[RHS]cEx_ExInd</a></span> <span class="id">cEx_trans_min_RV</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ex_cExT</span> (<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#miu:96">:</a></span> <span class="id">{RV</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-&gt;</a></span> <span class="id"><a href="robustmean.robustmean.html#F:95">R}</a></span>) <span class="id">:</span> <span class="id">`E</span> <span class="id">X</span> <span class="id">=</span> <span class="id">`E_[X</span> <span id="262f3f3084319fa0d768cbcdb0b60a44" class="id"><a name="262f3f3084319fa0d768cbcdb0b60a44" class="">|</a></span> <span class="id">[set:</span> <span class="id">U]]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">rewrite</span> <span class="id">/cEx</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span id="X:97" class="id"><a name="X:97" class="">do</a></span> <span class="id">rewrite</span> <span class="id">setIT</span> <span class="id">Pr_setT</span> <span class="id">divR1</span> <span class="id"><a href="robustmean.robustmean.html#X:97">-pr_eqE</a></span>.<br/>
<span class="comment">(*&nbsp;The&nbsp;names&nbsp;of&nbsp;lemmas&nbsp;for&nbsp;Pr&nbsp;are&nbsp;inconsistent:<br/>
&nbsp;&nbsp;&nbsp;some&nbsp;begin&nbsp;with&nbsp;"Pr"&nbsp;while&nbsp;others&nbsp;"pr"&nbsp;*)</span><br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">-Ex_comp_RV;</a></span> <span class="id">congr</span> <span class="id"><a href="robustmean.robustmean.html#G:100">`E</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a href="robustmean.robustmean.html#X:98">cVar</a></span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span id="var:102" class="id"><a name="var:102" class="">-&gt;</a></span> <span class="id">R}</span>) <span class="id"><a href="robustmean.robustmean.html#262f3f3084319fa0d768cbcdb0b60a44">F</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#X:98">:=</a></span> <span class="gallina-kwd">let</span> <span class="id">miu</span> <span class="id">:=</span> <span class="id">`E_[X</span> <span class="id"><a href="robustmean.robustmean.html#X:98">|</a></span> <span class="id">F]</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">`E_[</a></span>(<span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">`-cst</a></span> <span class="id">miu</span>) <span class="id">`^2</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">|</a></span> <span class="id">F]</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span class="id">&quot;`V_[ X | F ]&quot;</span> <span class="id">:=</span> (<span class="id">cVar</span> <span class="id">X</span> <span class="id">F</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Var_cVarT</span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">:</span> <span class="id">`V</span> <span class="id">X</span> <span class="id">=</span> <span class="id">`V_[X</span> <span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">[set:</a></span> <span class="id">U]]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/cVar</span> <span class="id">-!Ex_cExT</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">cEx_cVar</a></span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">F</span> <span class="id">G:</span> <span class="id">{set</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">U}</a></span>) <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_gt0">&lt;</a></span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>  <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">F</span> <span class="id">\subset</span> <span class="id">G</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">mu</span> <span class="id">:=</span> <span class="id">`E_[X</span> <span class="id"><a href="robustmean.robustmean.html#cEx_sub">|</a></span> <span class="id">G]</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">var</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">`V_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ex">|</a></span> <span class="id">G]</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">`|</span> <span class="id">`E_[</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">X</a></span> <span class="id">|</span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">]</a></span> <span class="id">-</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">mu</a></span> <span class="id">|</span> <span class="id">&lt;=</span> <span class="id">sqrt</span> (<span class="id">var</span> <span class="id">*</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">G</a></span> <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> ).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">move=&gt;</span> <span class="id">/[dup]</span> <span class="id">/invR_gt0</span> <span class="id">/ltRW</span> <span class="id">PrPFV_nneg</span> <span class="id">/[dup]</span> <span class="id">/invR_gt0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">PrPFV_pos</span> <span class="id">/[dup]</span> <span class="id">/Pr_gt0</span> <span class="id">PrPF_neq0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">PrPF_pos</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/[dup]</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#4f0eb16db53d2455b24b93c7e9f16e54">/</a></span>(<span class="id">Pr_incl</span> <span class="id">P</span>) <span class="id">/</span>(<span class="id">ltR_leR_trans</span> <span class="id">PrPF_pos</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/[dup]</span> <span class="id">/Pr_gt0</span> <span class="id">PrPG_neq0</span> <span class="id">PrPG_pos</span> <span class="id">FsubG</span> <span class="id">mu</span> <span class="id">var</span>.<br/>
<span class="id">rewrite</span> <span class="id">cEx_sub</span> <span class="id">//</span>.<br/>
<span class="id">pose</span> <span class="id">y</span> <span class="id">:=</span> <span class="id">sqrt</span> (<span class="id">Ex</span> <span class="id">P</span> (((<span class="id">X</span> <span class="id">`-cst</span> <span class="id">mu</span>) <span class="id">`^2</span>) <span class="id">`*</span> <span class="id">Ind</span> <span class="id">F</span>) <span class="id">*</span> <span class="id">Ex</span> <span class="id">P</span> (<span class="id">Ind</span> <span class="id">F</span>)) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>.<br/>
<span class="id">apply</span> <span class="id">leR_trans</span> <span class="gallina-kwd">with</span> (<span class="id">y</span> <span class="id">:=</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">divRE</span> <span class="id">leR_pmul2r</span> <span class="id">//</span> <span class="id">-sqrt_Rsqr_abs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sqrt_le_1_alt</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id">X</span> <span class="id">`-cst</span> <span class="id">mu</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">`*</a></span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">=</span> (<span class="id">X</span> <span class="id">`-cst</span> <span class="id">mu</span>) <span class="id">`*</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">`*</span> <span class="id">Ind</span> <span class="id">F</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">{1}I_double</a></span> <span class="id">boolp.funeqE</span><span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">rewrite</span> <span class="id">/mul_RV</span> <span class="id">mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/</span>(<span class="id">leR_trans</span> (<span class="id">Cauchy_Schwarz_proba</span> <span class="id">_</span> <span class="id">_</span>))<span class="id">/leR_eqVlt;</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">congr</span> (<span class="id">`E</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">_</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-I_square</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">boolp.funext</span> <span class="id">=&gt;</span> <span class="id">x/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">RHS]I_square</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/sq_RV/=/comp_RV/mul_RV</span> <span class="id">!mulR1</span> <span class="id">-mulRA</span> <span class="id">[in</span> <span class="id">LHS]</span>(<span class="id">mulRC</span> (<span class="id">Ind</span> <span class="id">F</span> <span class="id">x</span>)) <span class="id">!mulRA</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">/y</a></span> <span class="id">divRE</span> <span class="id">-</span>(<span class="id">sqrt_Rsqr</span> (<span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>)) <span class="id">//</span> <span class="id">-sqrt_mult_alt;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">apply</span> <span class="id">mulR_ge0;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">E_Ind</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">Ex_ge0</span> <span class="id">=&gt;</span> <span class="id">u;</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pmul">pow2_ge_0</a></span> <span class="id">|</span> <span class="id">apply</span> <span class="id">Ind_ge0]</span>.<br/>
<span class="id">apply</span> <span class="id">sqrt_le_1_alt</span>.<br/>
<span class="id">rewrite</span> <span class="id">/var</span> <span class="id">/cVar</span> <span class="id">-/mu</span> <span class="id">cEx_ExInd</span> <span class="id">!E_Ind</span> <span class="id">/Rsqr</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRCA</span> <span class="id">-!mulRA</span> <span class="id">mulRV</span> <span id="cEx_Var" class="id"><a name="cEx_Var" class="">//</a></span> <span class="id">mulR1</span> <span class="id">mulRC</span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#probability.P">rewrite</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">_</a></span> <span class="id">*</span> <span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">/</a></span> <span class="id"><a href="robustmean.robustmean.html#F:106">_]mulRC</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">mulRV</a></span> <span class="id">//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">mulR1</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">divRE</a></span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">apply</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">leR_wpmul2r</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">apply</span> <span class="id">leR_sumR=&gt;</span> <span class="id">i</span> <span class="id">iU</span>.<br/>
<span class="id">rewrite</span> <span class="id">-mulRA</span> <span class="id"><a href="robustmean.robustmean.html#Var_cVarT">-[X</a></span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">&lt;=</span> <span class="id">X]mulRA;</span> <span class="id">apply</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">leR_pmul</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">[exact:</span> <span class="id">Ind_ge0</span> <span class="id">|</span> <span class="id">move/Ind_subset:</span> <span class="id">FsubG;</span> <span class="id">apply</span> <span class="id">|</span> <span class="id">apply/RleP]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_Var</span> (<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">:</a></span> <span class="id">{RV</span> <span class="id"><a href="robustmean.robustmean.html#F:108">P</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">-&gt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">R}</a></span>) <span class="id">F</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>  <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`|</span> <span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">F</span> <span class="id">]</span> <span class="id">-</span> <span class="id">`E</span> <span class="id">X</span> <span class="id">|</span> <span class="id">&lt;=</span> <span class="id">sqrt</span> (<span class="id">`V</span> <span class="id">X</span> <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> ).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">move=&gt;</span> <span class="id">H;</span> <span class="id">rewrite</span> <span class="id">Ex_cExT</span> <span class="id">Var_cVarT</span>.<br/>
<span class="id">move:</span> (<span class="id">@cEx_cVar</span> <span class="id">X</span> <span class="id">F</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#congr_big">[set:</a></span> <span class="id">U]</span> <span class="id">H</span>) <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_setT</span> <span class="id">mulR1</span> <span class="id">subsetT;</span> <span class="id">apply</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_cptl</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">0</a></span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">-&gt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">&lt;</span> <span class="id">1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">*</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">+</span> <span class="id">`E_[X</span> <span class="id">|</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">~:</a></span> <span class="id">F</span>)<span class="id">]</span> <span class="id">*</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">F</span>) <span class="id">=</span> <span class="id">`E</span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">PrFgt0</span> <span class="id">PrFlt1</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">cEx_ExInd</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">Rdiv</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">big_distrl</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">rewrite</a></span> <span class="id">-big_split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="robustmean.robustmean.html#F:110">congr_big;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">move</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">i</a></span> <span class="id">HiU</span>. <span class="id"><a href="robustmean.robustmean.html#X:109">simpl</a></span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">unfold</a></span> <span class="id">&quot;`p_&quot;</span><span class="id">,</span> <span class="id">Ind</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">-mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">mulVR</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRN">rewrite</a></span> <span class="id">mulR1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">in_setC</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">i</span> <span class="id">\in</span> <span class="id">F</span>)<span class="id">;</span> <span class="id">simpl;</span> <span id="y:120" class="id"><span id="y:118" class="id"><span id="y:116" class="id"><span id="y:114" class="id"><span id="y:112" class="id"><a name="y:120" class="">lra</a></span></span></span></span></span>.<br/>
&nbsp;&nbsp;<span class="id">all:</span> <span class="id">apply</span> <span class="id"><a href="robustmean.robustmean.html#y:112">Pr_gt0;</a></span> <span class="id">try</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_Inv_int</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F:</span><br/>
<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">-&gt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_gt0">F</a></span> <span class="id">&lt;</span> <span class="id">1</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">*</span> (<span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">-</span> <span class="id">`E</span> <span class="id">X</span>) <span class="id">=</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">F</span>) <span class="id">*</span> <span class="id">-</span> (<span class="id">`E_[X</span> <span class="id">|</span> (<span class="id">~:</span> <span class="id">F</span>)<span class="id">]</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">-</a></span> <span class="id"><a href="robustmean.robustmean.html#probability.P">`E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">X</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRA">H</a></span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRDr</span> <span class="id">oppRD</span> <span class="id">mulRDr</span> <span class="id">oppRK</span> <span class="id">mulRN</span> <span class="id">mulRN</span>.<br/>
&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">cEx_ExInd</span>.<br/>
&nbsp;&nbsp;(<span class="id">repeat</span> <span class="id">have</span> <span class="id">-&gt;:</span> <span class="gallina-kwd">forall</span> <span class="id">x</span> <span class="id">y,</span> <span class="id">x</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRA">!=</a></span> <span class="id">0</span> <span class="id">-&gt;</span> <span class="id">x</span> <span class="id">*</span> (<span class="id">y</span> <span class="id">/</span> <span class="id">x</span>) <span class="id">=</span> <span class="id">y</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hz;</span> <span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">-mulRA</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.RIneq.html#Rplus_opp_l">mulVR;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[];</span> <span class="id">rewrite</span> <span class="id">mulR1</span>)<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#congr_big">;</a></span><br/>
&nbsp;&nbsp;<span class="id">try</span> <span class="id">apply</span> <span class="id">Pr_gt0;</span> <span class="id">try</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">try</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#dist_of_RV">lra</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rplus_eq_reg_r</span> <span class="gallina-kwd">with</span> (<span class="id">r:=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">*</span> <span class="id">`E</span> <span class="id">X</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-addRA</span> <span class="id">Rplus_opp_l</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">addR0</a></span> <span class="id">-addRA</span> <span class="id">addRC</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Rplus_eq_reg_r</span> <span class="gallina-kwd">with</span> (<span class="id">r:=`E</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">X</a></span> <span class="id">`*</span> <span class="id">Ind</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">~:</a></span> <span class="id">F</span>)<span class="id"><a href="robustmean.robustmean.html#probability.U">:{RV</a></span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>)).<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">rewrite</a></span> <span class="id">-addRA</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">Rplus_opp_l</a></span> <span class="id">addR0</span> <span class="id"><a href="robustmean.robustmean.html#G:123">-big_split</a></span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#X:121">rewrite</a></span> <span class="id">mulRDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-addRA</a></span> <span class="id">mulNR</span> <span class="id">Rplus_opp_l</span> <span class="id">addR0</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">mul1R</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">congr_big;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">auto</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move</span> <span class="id"><a href="robustmean.robustmean.html#G:123">=&gt;</a></span> <span class="id">i</span> <span class="id">HiU</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">&quot;`p_&quot;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-mulRDl</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltR_trans">_</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Ind/mul_RV</span> <span class="id">in_setC</span>.<br/>
&nbsp;&nbsp;<span class="id">elim</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invR_neq0'">i</a></span> <span class="id">\in</span> <span class="id">F</span>)<span class="id">;</span> <span class="id">simpl;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_Inv'</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">:</a></span> <span class="id">{set</span> <span class="id">U}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_gt0">-&gt;</a></span> <span class="id">F</span> <span class="id">\subset</span> <span class="id">G</span> <span class="id">-&gt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">&lt;</a></span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`|</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">-</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]|</span> <span class="id">=</span> (<span class="id">Pr</span> <span class="id">P</span> (<span class="id">G</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#subsetDl">:\:</a></span> <span class="id">F</span>)) <span class="id">/</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRCA">*</a></span> <span class="id">`|</span> <span class="id">`E_[X</span> <span class="id">|</span> (<span class="id">G</span> <span class="id"><a href="robustmean.robustmean.html#Ind_setD">:\:</a></span> <span class="id">F</span>)<span class="id">]</span> <span class="id">-</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]|</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">move=&gt;</span> <span class="id">PrPF_gt0</span> <span class="id">/[dup]</span> <span class="id">/setIidPr</span> <span class="id">GIFF</span> <span class="id">FsubG</span> <span class="id">/[dup]</span> <span class="id">/</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">ltR_trans</a></span> <span class="id">PrPF_gt0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">/[dup]</a></span> <span class="id">/Pr_gt0</span> <span class="id">/invR_neq0'</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">/eqP</a></span> <span class="id">PrPG_neq0</span> <span class="id">PrPG_gt0</span> <span class="id">PrPF_PrPG</span>.<br/>
<span class="id">have</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">G</span> <span class="id">:\:</span> <span class="id">F</span>) <span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.robustmean.html#mul_RV">rewrite</a></span> <span class="id">Pr_diff</span> <span class="id">subR_gt0</span> <span class="id">GIFF</span>.<br/>
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">/[dup]</span> <span class="id">/Pr_gt0</span> <span class="id">PrPGF_neq0</span> <span class="id">PrPGF_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">!cEx_sub</span> <span class="id">?subsetDl</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">//</a></span> <span class="id">!divRE</span> <span class="id"><a href="robustmean.robustmean.html#6c9dd003b11e32cff9b53d1e213c5753">mulRCA</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Ind_setD//</span>.<br/>
<span class="id">rewrite</span> <span class="id">!coqRE</span> <span class="id">mulrAC</span> <span class="id">divff//</span> <span class="id">mul1r</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">-!coqRE</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="robustmean.robustmean.html#cEx_sub">_</a></span> <span class="id">`*</span> (<span class="id">_</span> <span class="id">`-</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">_</a></span>) <span class="id">=</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#normR0">X</a></span> <span class="id">`-cst</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">`E_[X</a></span> <span class="id">|</span> <span class="id">G]</span>) <span class="id">`*</span> <span class="id">Ind</span> <span class="id">G</span> <span class="id">`-</span> (<span class="id">X</span> <span class="id">`-cst</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]</span>) <span class="id">`*</span> <span class="id">Ind</span> <span class="id">F</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>. <span class="comment">(*&nbsp;TODO:&nbsp;use&nbsp;ring_RV&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">rewrite</a></span> <span class="id">/mul_RV/sub_RV;</span> <span class="id">apply:</span> <span class="id">boolp.funext</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">u</a></span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">mulRBr</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">E_sub_RV</a></span>.<br/>
<span class="id">have</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-&gt;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#5a63ec97e49d200e143f23a117731d92">:</a></span> <span class="id">Ex</span> <span class="id">P</span> ((<span class="id">X</span> <span class="id">`-cst</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">G]</span>) <span class="id">`*</span> <span class="id"><a href="robustmean.robustmean.html#Ex_cExT">Ind</a></span> <span class="id">G</span>) <span class="id">=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_of_cplt">0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">normR0_eq0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id">@eqR_mul2r</span> (<span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span>)) <span class="id">//</span> <span class="id">-divRE</span> <span class="id">-cEx_sub</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_incl">//</a></span> <span class="id">subRR</span> <span class="id">normR0</span> <span class="id">mul0R</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqP">rewrite</a></span> <span class="id">sub0R</span> <span class="id">normRN</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_Inv</span> (<span class="id">X:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">{RV</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">P</a></span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">R}</a></span>) <span class="id">F</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="robustmean.robustmean.html#262f3f3084319fa0d768cbcdb0b60a44">&lt;</a></span> <span class="id">Pr</span> <span class="id"><a href="robustmean.robustmean.html#262f3f3084319fa0d768cbcdb0b60a44">P</a></span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#F:127">-&gt;</a></span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">&lt;</span> <span class="id">1</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`|</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">-</span> <span class="id">`E</span> <span class="id">X|</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">=</a></span> (<span class="id">1</span> <span class="id">-</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">*</span> <span class="id">`|</span> <span class="id">`E_[X</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TotalTheory.leNgt">|</a></span> (<span class="id">~:</span> <span class="id">F</span>)<span class="id">]</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#RleP">-</a></span> <span class="id">`E</span> <span class="id">X|</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">move=&gt;</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">*;</a></span> <span class="id">rewrite</span> <span class="id">Ex_cExT</span> <span class="id">-Pr_of_cplt</span> <span class="id">-setTD;</span> <span class="id">apply</span> <span class="id">cEx_Inv'</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#big_ind">=&gt;</a></span> <span class="id">//</span>.<br/>
<span class="id">apply</span> <span class="id">ltR_neqAle;</span> <span class="id">split;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/Pr_incl/subsetT</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/eqP;</span> <span class="id">rewrite</span> <span class="id">Pr_setT</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">-Pr_lt1</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cvariance_nonneg</span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ex">-&gt;</a></span> <span class="id">R}</span>) <span class="id">F</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">`V_[X</span> <span class="id">|</span> <span class="id">F]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">have</span> <span class="id">[/RltP</span> <span class="id">H|]</span> <span class="id">:=</span> <span class="id">boolP</span> (<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>)<span class="id">%mcR;</span> <span class="id">last</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#coqRE">first</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-leNgt</span> <span class="id">=&gt;</span> <span class="id">/RleP</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.algebra.ssrnum.html#Num.Theory.invr_ge0">Pr_ge0</a></span> <span class="id">P</span> <span class="id">F</span>) <span class="id">=&gt;</span> <span class="id">/[conj]</span> <span class="id">/eqR_le</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/cVar</span> <span class="id">/cEx;</span> <span class="id">apply</span> <span class="id">big_ind;</span> <span class="id">[exact/RleP|exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#sq_RV_ge0">addR_ge0|move=&gt;</a></span> <span class="id">i</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">setIC</span> <span class="id">Pr_domin_setI</span> <span class="id">//</span> <span class="id">mulR0</span> <span class="id">divRE</span> <span class="id">mul0R;</span> <span class="id">exact/RleP</span>.<br/>
<span class="id">rewrite</span> <span class="id">/cVar</span> <span class="id">cEx_ExInd</span> <span class="id">/Ex</span> <span class="id">/ambient_dist</span> <span class="id">divRE</span> <span class="id">big_distrl</span> <span class="id">/=</span>.<br/>
<span class="id">apply/RleP;</span> <span class="id">apply:</span> <span class="id">sumr_ge0</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_;</span> <span class="id">rewrite</span> <span id="Ind_one" class="id"><a name="Ind_one" class="">!coqRE</a></span> <span class="id">mulr_ge0//;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">rewrite</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">invr_ge0;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">apply/RleP</a></span>.<br/>
<span class="id">apply:</span> <span class="id">mulr_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply:</span> <span class="id">mulr_ge0;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply/RleP;</span> <span class="id">exact:</span> <span class="id">sq_RV_ge0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#mul_RV">/Ind;</a></span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079">variance_nonneg</a></span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#E_Ind">-&gt;</a></span> <span class="id">R}</span>) <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRV">&lt;=</a></span> <span class="id">`V</span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
 <span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">:=</span> <span class="id">cvariance_nonneg</span> <span id="X:130" class="id"><a name="X:130" class="">X</a></span> <span id="Y:131" class="id"><a name="Y:131" class="">setT;</a></span> <span class="id">rewrite</span> <span class="id">-Var_cVarT</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">Ind_one</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">F</a></span> <span class="id">:</span> <span class="id"><a href="robustmean.robustmean.html#X:130">Pr</a></span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">F</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">&lt;&gt;</a></span> <span class="id">0</span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">`E_[Ind</a></span> <span class="id">F</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span> <span class="id"><a href="robustmean.robustmean.html#cEx_ExInd">|</a></span> <span class="id">F]</span> <span class="id">=</span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move=&gt;</span> <span class="id">F0;</span> <span class="id">rewrite</span> <span class="id">cEx_ExInd</span>.<br/>
<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#E_add_RV">have</a></span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">`*</span> <span class="id">Ind</span> <span class="id">F</span> <span class="id">=</span> <span class="id">Ind</span> <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">f;</span> <span class="id">rewrite</span> <span class="id">/mul_RV</span> <span class="id">/Ind</span> <span class="id">boolp.funeqE</span> <span id="cEx_sub_RV" class="id"><a name="cEx_sub_RV" class="">=&gt;</a></span> <span class="id">u;</span> <span class="id">case:</span> <span class="id">ifPn;</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#R">?</a></span>(<span class="id">mulR0,mulR1</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id"><a href="robustmean.robustmean.html#F:135">rewrite</a></span> <span class="id">E_Ind</span> <span class="id">divRE</span> <span class="id"><a href="robustmean.robustmean.html#Y:134">mulRV//;</a></span> <span class="id">exact/eqP</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_add_RV</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#Rminus">X</a></span> <span class="id">Y</span> <span class="id">:</span> <span class="id">{RV</span> (<span class="id">P</span>) <span class="id">-&gt;</span> (<span class="id">R</span>)<span class="id">}</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">`E_[</span>(<span class="id">X</span> <span class="id">`+</span> <span class="id">Y</span>) <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">+</span> <span class="id">`E_[Y</span> <span class="id">|</span> <span class="id">F]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!cEx_ExInd</span> <span class="id">-mulRDl</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-E_add_RV</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">congr_big</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">i</span> <span class="id">HiU</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/mul_RV</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.analysis.Rstruct#R_eqType">mulRDl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_sub_RV</span> (<span class="id">X</span> <span class="id">Y:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#const_RV">{RV</a></span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F:</span> <span class="id"><a href="robustmean.robustmean.html#F:137">`E_[X</a></span> <span class="id">`-</span> <span class="id">Y</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">`E_[X|F]</span> <span class="id">-</span> <span class="id">`E_[Y|F]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!cEx_ExInd</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">Rminus</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-mulNR</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_morph_oppR</span> <span class="id">-mulRDl</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span id="X:138" class="id"><a name="X:138" class="">*</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">_</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span id="k:139" class="id"><a name="k:139" class="">-big_split</a></span> <span class="id"><a href="robustmean.robustmean.html#k:139">/=</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulNR</span> <span class="id">-mulRDl</span> <span class="id">-mulNR</span> <span class="id">-mulRDl</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_const_RV</span> (<span class="id">k</span> <span class="id">:</span> <span class="id">R_eqType</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span id="X:140" class="id"><a name="X:140" class="">P</a></span> <span class="id">F</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#probability.P">`E_[</a></span>(<span class="id">const_RV</span> <span class="id">P</span> <span class="id">k</span>) <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">k</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#k:141">move</a></span> <span class="id"><a href="robustmean.robustmean.html#F:142">=&gt;</a></span> <span class="id">HPrPF</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">rewrite</a></span> <span class="id">cEx_ExInd</span> <span class="id">E_scalel_RV</span> <span class="id">E_Ind</span> <span class="id">/Rdiv</span> <span class="id">-mulRA</span> <span class="id">mulRV;</span> <span class="id">[rewrite</span> <span class="id">mulR1</span> <span class="id">|</span> <span class="id">apply</span> <span class="id">gtR_eqF]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">const_RC</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">k:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#scalel_RV">X</a></span> <span class="id">`*cst</span> <span class="id">k</span> <span class="id">=</span> <span class="id">k</span> <span class="id">`cst*</span> <span class="id">X</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">&quot;`*cst&quot;, &quot;`cst*&quot;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">boolp.funeqE</span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulRC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_scaler_RV</span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> (<span class="id">P</span>) <span class="id">-&gt;</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">R</a></span>)<span class="id">}</span>) (<span class="id">k</span> <span class="id"><a href="robustmean.robustmean.html#cEx_scaler_RV">:</a></span> <span class="id">R</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">`E_[</span>(<span class="id">X</span> <span class="id">`*cst</span> <span class="id">k</span>) <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">*</span> <span class="id">k</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#R">!cEx_ExInd</a></span> <span class="id">mulRC</span> <span class="id">mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id"><a href="robustmean.robustmean.html#m:147">_</a></span>).<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">rewrite</a></span> <span class="id"><a href="robustmean.robustmean.html#X:146">-E_scalel_RV</a></span> <span class="id">const_RC</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">&quot;`cst*&quot;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulRA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_scalel_RV</span> (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> (<span class="id">P</span>) <span class="id">-&gt;</span> (<span class="id">R</span>)<span class="id">}</span>) (<span class="id">k</span> <span class="id">:</span> <span class="id">R</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">`E_[</span>(<span class="id">k</span> <span class="id">`cst*</span> <span class="id">X</span>) <span id="cEx_trans_RV_id_rem" class="id"><a name="cEx_trans_RV_id_rem" class="">|</a></span> <span class="id">F]</span> <span class="id">=</span> <span class="id">k</span> <span class="id">*</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">mulRC</a></span> <span class="id"><a href="robustmean.robustmean.html#X:149">-cEx_scaler_RV</a></span> <span class="id">const_RC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_trans_add_RV</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-&gt;</a></span> <span class="id">R}</span>) <span class="id">m</span> <span class="id">F:</span> <br/>
<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`E_[X</span> <span class="id">`+cst</span> <span class="id">m</span> <span class="id">|</span> <span class="id">F]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">=</a></span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">+</span> <span class="id">m</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">HPrPF_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">have:</span> <span class="id">`E_[const_RV</span> <span class="id">P</span> <span class="id">m</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">m</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">cEx_const_RV</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">HcExm</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}HcExm</span> <span class="id">-cEx_add_RV</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_trans_RV_id_rem</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">P</a></span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">m</span> <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#F:153">`E_[</a></span>(<span class="id">X</span> <span class="id">`-cst</span> <span class="id">m</span>) <span class="id">`^2</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">`E_[</span>((<span class="id">X</span> <span class="id">`^2</span> <span class="id">`-</span> (<span class="id">2</span> <span class="id">*</span> <span class="id">m</span> <span class="id">`cst*</span> <span class="id">X</span>)) <span class="id">`+cst</span> <span class="id">m</span> <span class="id">^</span> <span class="id">2</span>) <span class="id">|</span> <span class="id">F]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span id="cVarE" class="id"><a name="cVarE" class="">rewrite</a></span> <span id="X:154" class="id"><a name="X:154" class="">!cEx_ExInd</a></span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id"><a href="robustmean.robustmean.html#262f3f3084319fa0d768cbcdb0b60a44">_</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id"><a href="robustmean.robustmean.html#F:155">_</a></span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">rewrite</a></span> <span class="id"><a href="robustmean.robustmean.html#F:155">/sub_RV</a></span> <span class="id">/trans_add_RV</span> <span class="id">/trans_min_RV</span> <span class="id">/sq_RV</span> <span class="id">/=</span> <span class="id">/comp_RV</span> <span class="id">/scalel_RV</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/ambient_dist;</span> <span class="id">field</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cEx_Pr_eq0</span> (<span class="id">X:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">=</span> <span class="id">0</span> <span class="id">-&gt;</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id"><a href="robustmean.robustmean.html#cEx_scalel_RV">move</a></span> <span class="id">=&gt;</span> <span class="id">PrF0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">cEx_ExInd</span> <span class="id">PrF0</span> <span class="id"><a href="robustmean.robustmean.html#cVar">!coqRE</a></span> <span class="id">invr0</span> <span class="id">mulr0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cVarE</span> (<span class="id">X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">:</a></span> <span class="id">{RV</span> (<span class="id">P</span>) <span class="id">-&gt;</span> (<span class="id">R</span>)<span class="id">}</span>) <span class="id">F:</span><br/>
&nbsp;&nbsp;<span class="id">`V_[X</span> <span class="id">|</span> <span class="id">F]</span> <span id="X:156" class="id"><a name="X:156" class="">=</a></span> <span class="id">`E_[X</span> <span class="id"><a href="robustmean.robustmean.html#probability.P">`^2</a></span> <span class="id">|</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">F]</a></span> <span id="F:157" class="id"><a name="F:157" class="">-</a></span> <span id="x:158" class="id"><a name="x:158" class="">`E_[X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">|</a></span> <span class="id">F]</span> <span class="id">^</span> <span class="id">2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fcad49e90c66bc3092b4ceff11a64f43">have:</a></span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="robustmean.robustmean.html#262f3f3084319fa0d768cbcdb0b60a44">Pr_ge0</a></span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">case</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">=&gt;</a></span> <span class="id"><a href="robustmean.robustmean.html#X:156">[HPr_gt0</a></span> <span class="id"><a href="robustmean.robustmean.html#x:158">|</a></span> <span class="id">HPr_eq0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/cVar</span> <span class="id">cEx_trans_RV_id_rem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="robustmean.robustmean.html#cVarE">rewrite</a></span> <span class="id">cEx_trans_add_RV;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">cEx_sub_RV</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">cEx_scalel_RV</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/cVar</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">!cEx_Pr_eq0;</a></span> <span class="id">first</span> (<span class="id">simpl;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">mul0R</a></span> <span class="id">subR0</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cVarDist</span> (<span class="id">X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">:</a></span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) <span class="id">F</span> <span class="id">x:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`E_[</span>(<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#cEx_scalel_RV">`-cst</a></span> <span class="id">x</span>) <span class="id">`^2</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`V_[X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#const_RV">|</a></span> <span class="id">F]</span> <span class="id">+</span> (<span class="id">`E_[X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">|</a></span> <span class="id">F]</span> <span class="id">-</span> <span class="id">x</span>)².<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">HPrPF</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">Rsqr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">cVarE</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl;</span> <span class="id">rewrite</span> <span class="id">mulR1</span> <span class="id">mulRDl</span> <span class="id">!mulRDr</span> <span class="id">!addRA</span> <span class="id">-</span>(<span class="id">mulRC</span> (<span class="id">-</span> <span class="id">_</span>)) <span class="id">-!addRA</span> <span class="id">addRA</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">addRA</a></span> <span class="id">-</span>(<span class="id">addRA</span> <span class="id">_</span> (<span class="id">-</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#trans_min_RV">_</a></span>)) (<span class="id">addRC</span> (<span class="id">-</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#scalel_RV">have</a></span> <span class="id">-&gt;:</span>  <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#const_RV">`E_[X</a></span> <span class="id">|</span> <span class="id">F]</span> <span class="id">*</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">+</span> <span class="id">-</span> (<span class="id">`E_[X</span> <span class="id">|</span> <span class="id">F]</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">`E_[X</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">|</a></span> <span class="id">F]</span>) <span class="id">=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDr">0</a></span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">subRR</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">addR0</span> <span class="id">-!cEx_scalel_RV</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">&lt;-:</span> <span class="id">`E_[</span>(<span class="id">const_RV</span> <span class="id">P</span> (<span class="id"><a href="robustmean.robustmean.html#cVar">-x</a></span> <span class="id">*</span> <span class="id">-x</span>)) <span class="id">|</span> <span class="id">F]</span> <span class="id">=</span> (<span class="id">-x</span> <span class="id">*</span> <span class="id">-x</span>) <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">cEx_const_RV</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span id="resilience" class="id"><a name="resilience" class="">-!cEx_add_RV</a></span> <span class="id">!cEx_ExInd</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span id="resilience.P" class="id"><a name="resilience.P" class="">*</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">congr</span> (<span id="X:162" class="id"><a name="X:162" class="">_</a></span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">_</a></span>)<span class="id">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">&quot;`-cst&quot;, &quot;`^2&quot;, &quot;`o&quot;, &quot;`cst*&quot;, const_RV, &quot;`+&quot;</span><span class="id"><a href="robustmean.robustmean.html#F:163">;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">rewrite</a></span> <span class="id"><a href="robustmean.robustmean.html#resilience.P">!mulR1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.fintype.html#4102da6205bd8605932488256a8bd517">mulRDl</a></span> <span class="id">!mulRDr</span> <span class="id">!addRA</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-</a></span>(<span class="id">mulRC</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-_</a></span>)).<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">probability</a></span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`V_[ X | F ]&quot;</span> <span class="id">:=</span> (<span class="id">cVar</span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">F</a></span>) <span class="id"><a href="robustmean.robustmean.html#delta:161">:</a></span> <span class="id">proba_scope</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">Ind_one</span> <span class="id">{U</span> <span class="id">P}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#a686f16c7fee28a2e0daca8726c6780b">resilience</a></span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">cresilience</span> (<span class="id">delta</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">:</a></span> <span class="id"><a href="robustmean.robustmean.html#resilience.P">R</a></span>) (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span class="id">-&gt;</span> <span class="id">R}</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">{set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">U}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">delta</span> <span class="id">-&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setID">delta</a></span> <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span> <span class="id">-&gt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span> <span class="id">-&gt;</span> <span class="id">F</span> <span class="id">\subset</span> <span class="id">G</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">`|</a></span> <span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">F</a></span> <span class="id">]</span> <span class="id">-</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">`E_[</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">X</a></span> <span class="id">|</span> <span class="id">G</span> <span class="id">]</span> <span class="id">|</span> <span class="id">&lt;=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sqrt</span> (<span class="id">`V_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">G</span> <span class="id">]</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">delta</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">/</a></span> <span class="id">delta</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">delta_gt0</span> <span class="id">delta_FG</span> <span class="id">Pr_FG</span> <span class="id">/[dup]</span> <span class="id">/setIidPr</span> <span class="id">HGnF_F</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setDidPl">FG</a></span>.<br/>
<span class="id">have</span> <span class="id">[Pr_FG_eq|/eqP</span> <span class="id">Pr_FG_neq]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>) (<span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">FGFG</span> <span class="id">:</span> <span class="id">F</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqP">:|:</a></span> <span class="id">G</span> <span class="id">:\:</span> <span class="id">F</span> <span class="id">=</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">:=</span> <span class="id">setID</span> <span class="id">G</span> <span class="id">F;</span> <span class="id">have</span> <span class="id">:=</span> <span class="id">setIidPl</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">FG;</a></span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#u:172">setIC</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">GFP0</span> <span class="id">:</span> <span class="id">\sum_</span>(<span class="id">u</span> <span class="gallina-kwd">in</span> <span class="id">G</span> <span class="id">:\:</span> <span class="id">F</span>) <span class="id">P</span> <span class="id">u</span> <span class="id">=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> <span class="id">Pr_FG_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">=</span> <span class="id">X</span> <span class="id">-&gt;</span> <span class="id">_]FGFG</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">[in</a></span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">_</a></span> <span class="id">=</span> <span class="id">X</span> <span class="id">-&gt;</span> <span class="id">_]/Pr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_union/=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/setDidPl;</span> <span class="id">rewrite</span> <span class="id">setDDl</span> <span class="id">setUid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/eqP;</span> <span class="id">rewrite</span> <span class="id">addRC</span> <span class="id">-subr_eq</span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">&lt;-;</span> <span class="id">rewrite</span> <span class="id">/Pr</span> <span class="id">subrr</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">{}GFP0</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">u,</span> <span class="id">u</span> <span class="id">\in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">G</a></span> <span class="id">:\:</span> <span class="id">F</span> <span class="id">-&gt;</span> <span class="id">P</span> <span class="id">u</span> <span class="id">=</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move/psumr_eq0P</span> <span class="id">:</span> <span class="id">GFP0;</span> <span class="id">exact</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!cExE</span> <span class="id">Pr_FG_eq</span> <span class="id">-Rdiv_minus_distr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">`|</span>(<span class="id">_</span> <span class="id">-</span> <span class="id">X</span>) <span class="id">/</span> <span class="id">_|]FGFG</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">big_union/=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/setDidPl;</span> <span class="id">rewrite</span> <span class="id">setDDl</span> <span class="id">setUid</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">rewrite</a></span> <span class="id">subRD</span> <span class="id">subRR</span> <span class="id">sub0R</span> <span class="id">big1</span> <span class="id">?oppR0</span> <span class="id">?div0R</span> <span class="id">?normR0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">/GFP0</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">mulR0</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/sqrt_pos</span>.<br/>
<span class="id">have</span> <span class="id">[?|/eqP</span> <span class="id">PrF_neq0]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>) <span class="id">0;</span> <span class="id">first</span> <span class="id">nra</span>.<br/>
<span class="id">have</span> <span class="id">[?|/eqP</span> <span class="id">PrG_neq0]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span>) <span class="id">0;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id"><a href="robustmean.robustmean.html#cEx_cVar">:=</a></span> <span class="id">Pr_ge0</span> <span class="id">P</span> <span class="id">F;</span> <span class="id">nra</span>.<br/>
<span class="id">have</span> <span class="id">HPrFpos</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">Pr_ge0</a></span> <span class="id">P</span> <span class="id">F;</span> <span class="id">lra</span>.<br/>
<span class="id">have</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_wpmul2l">HPrGpos</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span> <span class="gallina-kwd">by</span> <span class="id">have</span> <span class="id">:=</span> <span class="id">Pr_ge0</span> <span class="id">P</span> <span class="id">G;</span> <span class="id">lra</span>.<br/>
<span class="id">have</span> <span class="id">delta_lt1</span> <span class="id">:</span> <span class="id">delta</span> <span class="id">&lt;</span> <span class="id">1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/</span>(<span class="id">leR_ltR_trans</span> <span class="id">delta_FG</span>)<span class="id">/ltR_pdivr_mulr;</span> <span class="id">lra</span>.<br/>
<span class="id">case</span> <span class="id">:</span> (<span class="id">Rle_or_lt</span> <span class="id">delta</span> (<span class="id">1/2</span>)) <span class="id">=&gt;</span> <span class="id">delta_12</span>.<br/>
<span class="comment">(*Pr&nbsp;P&nbsp;F&nbsp;&lt;=&nbsp;1/2&nbsp;,&nbsp;A.3&nbsp;implies&nbsp;the&nbsp;desired&nbsp;result*)</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">leR_trans</span> (<span class="id">cEx_cVar</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">_</a></span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sqrt_le_1_alt</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!divRE</span> <span class="id">-!mulRA;</span> <span class="id">apply</span> (<span class="id">leR_wpmul2l</span> (<span class="id">cvariance_nonneg</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@leR_trans</span> (<span class="id">1/delta</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">leR_pdivl_mulr</span> <span class="id">delta</span>) <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">-leR_pdivl_mulr;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">divR_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">div1R</span> <span class="id">invRM</span> <span class="id">?gtR_eqF</span> <span class="id">//;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">invR_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">invRK</span> <span class="id">?gtR_eqF</span> <span class="id">//</span> <span class="id">mulRC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!divRE</span> <span class="id">mulRA</span> <span class="id">leR_pmul2r;</span> <span class="id"><a href="robustmean.robustmean.html#resilience.P">[lra|exact:</a></span> <span class="id">invR_gt0]</span>.<br/>
<span class="id">rewrite</span> <span class="id">cEx_Inv'//;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
<span class="id">apply:</span> <span class="id">leR_trans</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">divR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">cEx_cVar</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">subsetDl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_diff</span> <span class="id">HGnF_F</span> <span class="id">subR_gt0;</span> <span class="id">lra</span>.<br/>
<span class="id">apply:</span> (<span class="id">@leR_trans</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sqrt</span> (<span class="id">`V_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">G]</span> <span class="id">*</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">delta</span>)) <span class="id">/</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">G</a></span> <span class="id">*</span> <span class="id">delta</span> <span class="id">*</span> <span class="id">delta</span>)))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">Rabs_pos_eq</span> (<span class="id">Pr</span> <span class="id">P</span> (<span class="id">G</span> <span class="id">:\:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_diff">F</a></span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">divR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-sqrt_Rsqr_abs;</span> <span class="id">rewrite</span> <span class="id">-sqrt_mult_alt;</span> <span class="id">last</span> <span class="id">exact:</span> <span class="id">Rle_0_sqr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">sqrt_le_1_alt</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!divRE</span> <span class="id">!mulRA</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">X</span> <span class="id">&lt;=</span> <span class="id">_]</span>(<span class="id">mulRC</span> <span class="id">_</span>  (<span class="id">`V_[X</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_pdivl_mulr">|</a></span> <span class="id">G]</span>)) <span class="id">-!mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">cvariance_nonneg</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!mulRA</span> <span class="id">mulRC</span> <span class="id">!mulRA</span> <span class="id">mulVR</span> <span class="id">?mul1R;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_diff</span> <span class="id">HGnF_F;</span> <span class="id">apply/eqP;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRC</span> (<span class="id">mulRC</span> (<span class="id">/Pr</span> <span class="id">P</span> <span class="id"><a href="robustmean.robustmean.html#resilience.P">F</a></span>)) <span class="id">-mulRA</span> <span class="id">-invRM;</span> <span class="id">[|exact/gtR_eqF|exact/gtR_eqF]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRA;</span> <span class="id">apply/leR_pdivr_mulr;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRAC;</span> <span class="id">apply/leR_pdivl_mulr;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_diff">apply:</a></span> <span class="id">Rmult_lt_0_compat;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">move/leR_pdivl_mulr</span> <span class="id">:</span> <span class="id">delta_FG</span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">HPrGpos</span>) <span class="id">=&gt;</span> <span class="id">delta_FG</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#divRE">apply</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#invRM">Rmult_le_compat_r</a></span> <span class="gallina-kwd">with</span> (<span class="id">r:=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span>) <span class="gallina-kwd">in</span> <span class="id">delta_FG</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">mulRC</span> (<span class="id">Pr</span> <span class="id">P</span> <span class="id">G</span>)) <span class="id">-mulRA;</span> <span class="id">apply:</span> <span class="id">leR_pmul</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id">mulR_ge0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/mulR_ge0;</span> <span class="id">last</span> <span class="id">exact/ltRW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#gtR_eqF">=&gt;</a></span> <span class="id">//;</span> <span class="id">exact/ltRW</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_diff</span> <span class="id">HGnF_F;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul1R">rewrite</a></span> <span class="id">mulRCA;</span> <span class="id">apply:</span> <span class="id">leR_pmul;</span> <span class="id">nra</span>.<br/>
<span class="id">apply</span> <span class="id">sqrt_le_1_alt</span>.<br/>
<span class="id">rewrite</span> <span class="id">divRE</span> <span class="id">invRM;</span> <span class="id">[|exact/gtR_eqF/mulR_gt0|exact/gtR_eqF]</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRA;</span> <span class="id">apply/leR_pmul2r;</span> <span class="id">first</span> <span class="id">exact/invR_gt0</span>.<br/>
<span class="id">rewrite</span> <span class="id">-!mulRA;</span> <span id="resilience" class="id"><a name="resilience" class="">apply:</a></span> <span class="id">leR_wpmul2l;</span> <span class="id"><a href="robustmean.robustmean.html#R">first</a></span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">cvariance_nonneg</a></span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#delta:175">rewrite</a></span> <span class="id">invRM;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">[|exact/gtR_eqF|exact/gtR_eqF]</a></span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">rewrite</a></span> <span class="id">mulRCA</span> (<span class="id">mulRA</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">Pr</a></span> <span class="id">P</span> <span class="id">G</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">mulRV</a></span> <span class="id">?mul1R;</span> <span class="id">last</span> <span class="id">exact/gtR_eqF</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRC;</span> <span class="id">apply/leR_wpmul2r;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-div1R;</span> <span class="id">apply/leR_pdivr_mulr</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">nra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">resilience</span> (<span class="id">delta</span> <span class="id">:</span> <span class="id">R</span>) (<span class="id">X</span> <span class="id">:</span> <span class="id">{RV</span> <span class="id">P</span> <span id="robustmean" class="id"><a name="robustmean" class="">-&gt;</a></span> <span class="id">R}</span>) <span class="id">F</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">delta</span> <span id="robustmean.U" class="id"><a name="robustmean.U" class="">-&gt;</a></span> <span class="id">delta</span> <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">F</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.fdist#ace7319b60c40bb8a888ede7917d5f1a">`|</a></span> <span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">F</span> <span id="robust_mean" class="id"><a name="robust_mean" class="">]</a></span> <span class="id">-</span> <span class="id">`E</span> <span class="id">X</span> <span class="id">|</span> <span class="id">&lt;=</span> <span class="id">sqrt</span> (<span class="id">`V</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#d8708f36d374a98f4d683c7593d1ea6a">X</a></span> <span class="id">*</span> <span class="id">2</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.U">*</a></span> (<span class="id">1</span> <span id="X:182" class="id"><a name="X:182" class="">-</a></span> <span class="id">delta</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#8fe87352e8bd617fea784762bca86e00">/</a></span> <span class="id">delta</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">move=&gt;</span> <span id="bad:184" class="id"><a name="bad:184" class="">delta_gt0</a></span> <span class="id"><a href="robustmean.robustmean.html#good:180">delta_F</a></span>.<br/>
<span class="id">have</span> <span id="mu_hat:185" class="id"><a name="mu_hat:185" class="">:=</a></span> <span class="id">@cresilience</span> <span class="id"><a href="robustmean.robustmean.html#X:182">_</a></span> <span class="id">X</span> <span class="id">F</span> <span class="id"><a href="robustmean.robustmean.html#drop:181">setT</a></span> <span class="id">delta_gt0</span>.<br/>
<span id="mu:186" class="id"><a name="mu:186" class="">rewrite</a></span> <span class="id">Pr_setT</span> <span class="id">divR1</span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">delta_F</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">-Ex_cExT</a></span> <span class="id">-Var_cVarT</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply;</span> <span class="id">[exact:</span> <span class="id">Pr_1|exact/subsetT]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">resilience</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">robustmean</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span> <span class="id">:</span> <span class="id">finType</span>) (<span class="id">P</span> <span class="id">:</span> <span class="id">{fdist</span> <span class="id">U}</span>).<br/>
<br/>
<span class="vernacular">Theorem</span> <span class="id">robust_mean</span> (<span class="id">good</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">drop:</a></span> <span class="id">{set</span> <span class="id">U}</span>) (<span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#eps:183">:</a></span> <span class="id">{RV</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">-&gt;</a></span> <span class="id">R}</span>) (<span class="id"><a href="robustmean.robustmean.html#mu:186">eps</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">:</a></span> <span class="id">R</span>)<span class="id"><a href="robustmean.robustmean.html#y:188">:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">bad</span> <span class="id">:=</span> <span class="id">~:</span> <span class="id">good</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">mu_hat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">:=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">`E_[</a></span> <span class="id">X</span> <span class="id"><a href="robustmean.robustmean.html#sigma:187">|</a></span> <span class="id">~:</span> <span class="id">drop</span> <span class="id">]</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">mu</span> <span class="id">:=</span> <span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">good</span> <span class="id">]</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">sigma</span> <span class="id">:=</span> <span class="id">`V_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">good</span> <span class="id">]</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id">&lt;</span> <span class="id">eps</span> <span class="id">-&gt;</span> <span class="id">eps</span> <span class="id">&lt;=</span> <span class="id">1/8</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">Pr</span> <span class="id">P</span> <span class="id">bad</span> <span class="id">=</span> <span class="id">eps</span> <span class="id">-&gt;</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.P">drop</a></span> <span class="id">=</span> <span class="id">4</span> <span class="id">*</span> <span class="id">eps</span> <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span class="id">y,</span> <span class="id">y</span> <span class="id">\in</span> <span class="id">bad</span> <span class="id">-&gt;</span> <span class="id">sqrt</span> (<span class="id">sigma</span> <span class="id">/</span> <span class="id">eps</span>) <span class="id">&lt;</span> <span class="id">`|</span> <span class="id">X</span> <span class="id">y</span> <span class="id">-</span> <span class="id">mu</span> <span class="id">|</span> <span class="id">-&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">y</a></span> <span class="id">\in</span> <span class="id">drop</span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">mu_hat</a></span> <span class="id">-</span> <span class="id">mu</span> <span class="id">|</span> <span class="id">&lt;=</span>  <span class="id">8</span> <span class="id">*</span> <span class="id">sqrt</span> (<span class="id">sigma</span> <span class="id">/</span> <span class="id">eps</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">move=&gt;</span> <span class="id">bad</span> <span class="id">mu_hat</span> <span class="id">mu</span> <span class="id">sigma</span> <span class="id">Hmin_outliers</span> <span class="id">Hmax_outliers</span> <span class="id">Hbad_ratio</span> <span class="id">Hdrop_ratio</span><br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr">Hquantile_drop_bad</a></span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">have</a></span> <span class="id">H</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.P">:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">Pr</a></span> <span class="id">P</span> <span class="id">good</span> <span class="id">=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">1</a></span> <span class="id">-</span> <span class="id">eps</span> <span class="gallina-kwd">by</span> <span class="id">apply/esym/subR_eq;</span> <span class="id">rewrite</span> <span class="id">-Hbad_ratio</span> <span class="id">Pr_cplt</span>.<br/>
<span class="comment">(*&nbsp;On&nbsp;the&nbsp;other&nbsp;hand,&nbsp;we&nbsp;remove&nbsp;at&nbsp;most&nbsp;4ε&nbsp;good&nbsp;points&nbsp;*)</span><br/>
<span class="id">have</span> <span class="id">max_good_drop</span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:&amp;:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setI_eq0">drop</a></span>) <span class="id">&lt;=</span> <span class="id">4</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setDIl">*</a></span> <span class="id">eps</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Hdrop_ratio;</span> <span class="id">exact/Pr_incl/subsetIr</span>.<br/>
<span class="id">pose</span> <span class="id">eps'</span> <span class="id">:=</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltRW">:\:</a></span> <span class="id">drop</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>).<br/>
<span class="id">have</span> <span class="id">Hcompl</span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>) <span class="id">=</span> <span class="id">1</span> <span class="id">-</span> <span class="id">eps'</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/esym/subR_eq;</span> <span class="id">rewrite</span> <span class="id">/eps'</span> <span class="id">-mulRDl</span> <span class="id">-Pr_union_disj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_incl">-setDUl</a></span> <span class="id">setUCr</span> <span class="id">setTD</span> <span class="id">mulRV//</span> <span class="id">Pr_of_cplt;</span> <span class="id">apply/eqP;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-setI_eq0</span> <span class="id">-setDIl</span> <span class="id">setICr</span> <span class="id">set0D</span>.<br/>
<span class="id">have</span> <span class="id">eps'_ge0</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id">eps'</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">mulR_ge0</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/ltRW/invR_gt0;</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">lra</span>.<br/>
<span class="id">have</span> <span class="id">eps'_le1</span> <span class="id">:</span> <span class="id">eps'</span> <span class="id">&lt;=</span> <span class="id">1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/eps';</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">apply/leR_pdivr_mulr;</a></span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">mul1R;</a></span> <span class="id">exact/Pr_incl/subsetDr</span>.<br/>
<span class="comment">(*&nbsp;Remaining&nbsp;good&nbsp;points:&nbsp;1&nbsp;-&nbsp;(4&nbsp;*&nbsp;eps)&nbsp;/&nbsp;(1&nbsp;-&nbsp;eps)&nbsp;*)</span><br/>
<span class="id">pose</span> <span class="id">delta</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">:=</a></span> <span class="id">1</span> <span class="id"><a href="robustmean.robustmean.html#X:189">-</a></span> (<span class="id">4</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulVR">eps</a></span>) <span class="id">/</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>).<br/>
<span class="id">have</span> <span class="id">min_good_remain</span> <span class="id">:</span> <span class="id">delta</span> <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/delta</span> <span class="id">Pr_diff</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@leR_trans</span> ((<span class="id">1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">-</a></span> <span class="id">eps</span> <span class="id">-</span> <span class="id">4</span> <span class="id">*</span> <span class="id">eps</span>) <span class="id">/</span> (<span class="id">1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">-</a></span> <span class="id">eps</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/leR_pdivl_mulr;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulRDl</span> <span class="id">-mulNR</span> <span class="id">-</span>(<span class="id">mulRA</span> <span class="id">_</span> (<span class="id">/</span> <span class="id">_</span>)) <span class="id">Rinv_l;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leR_pdivr_mulr;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">&lt;=</span> <span class="id">X]mulRA</span> <span class="id">mulVR</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">?mulR1;</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">first</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">apply/eqP;</a></span> <span class="id">lra</span>.<br/>
<span class="id">have</span> <span class="id">delta_gt0</span> <span class="id">:</span> <span class="id">0</span> <span class="id">&lt;</span> <span class="id">delta</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">@ltR_pmul2r</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">-</a></span> <span class="id">eps</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0R</span> <span class="id">mulRDl</span> <span class="id">mul1R</span> <span class="id">-mulNR</span> <span class="id">-mulRA</span> <span class="id">Rinv_l;</span> <span class="id">lra</span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#robustmean.P">have</a></span> <span class="id">delta_le1</span> <span class="id">:</span> <span class="id">delta</span> <span class="id">&lt;=</span> <span class="id">1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id">@leR_pmul2r</span> (<span class="id">1</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">-</a></span> <span class="id">eps</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mul1R</span> <span class="id">mulRDl</span> <span class="id">mul1R</span> <span class="id">-mulNR</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_pos">-mulRA</a></span> <span class="id">Rinv_l</span> <span class="id">?mulR1;</span> <span class="id">lra</span>.<br/>
<span class="id">have</span> <span class="id">Exgood_bound</span> <span class="id">:</span> <span class="id">`|</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">]</span> <span class="id">-</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">good]</span> <span class="id">|</span> <span class="id">&lt;=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sqrt</span> (<span class="id">`V_[X</span> <span class="id">|</span> <span class="id">good]</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">delta</span>) <span class="id">/</span> <span class="id">delta</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[gdg|gdg]</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">:=</a></span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>)) (<span class="id">Pr</span> <span class="id">P</span> <span class="id">good</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">suff</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_eq">:</a></span> <span class="id">`E_[X</span> <span class="id">|</span> (<span class="id">good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addRC">:\:</a></span> <span class="id">drop</span>)<span class="id">]</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_eq">=</a></span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">good]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setIC">subRR</a></span> <span class="id">normR0;</span> <span class="id">exact:</span> <span class="id">sqrt_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">gdg;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span> <span class="id">*</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">setIDA</span> <span class="id">Pr_diff</span> <span class="id">-setIA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NB:&nbsp;lemma?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/subR_eq;</span> <span class="id">rewrite</span> <span class="id">addRC;</span> <span class="id">apply/subR_eq;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">rewrite</a></span> <span class="id">subRR;</span> <span class="id">apply/esym</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> <span class="id">gdg;</span> <span class="id">rewrite</span> <span class="id">Pr_diff</span> <span class="id">=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_incl">/subR_eq;</a></span> <span class="id">rewrite</span> <span class="id">addRC</span> <span class="id">=&gt;</span> <span class="id">/subR_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">subRR</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.P">_</a></span> <span class="id">-&gt;</span> <span class="id">X]setIC</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">/esym;</a></span> <span class="id">exact:</span> <span class="id">Pr_domin_setI</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">cresilience</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">+</a></span> <span class="id">apply</span> (<span class="id">@ltR_pmul2r</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0R;</span> <span class="id">apply:</span> <span class="id">mulR_gt0</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">suff</span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">&lt;=</span> <span class="id">Pr</span> <span class="id">P</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">good</a></span> <span class="gallina-kwd">by</span> <span class="id">move/eqP</span> <span class="gallina-kwd">in</span> <span class="id">gdg;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/Pr_incl/subsetDl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#88ff5c4bf975d1d1d8f66e00f29a2516">+</a></span> <span class="id">exact:</span> <span class="id">subsetDl</span>.<br/>
<span class="id">have</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#e768fa080234c1fdf3a88cd16dc231c5">Exbad_bound</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">:</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">&lt;</a></span> <span class="id">Pr</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">P</a></span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|</span> <span class="id"><a href="robustmean.robustmean.html#i:191">`E_[</a></span> <span class="id">X</span> <span class="id">|</span> <span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">]</span> <span class="id">-</span> <span class="id">mu</span> <span class="id">|</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.bigop.html#eq_bigr">&lt;=</a></span> <span class="id">sqrt</span> (<span class="id">sigma</span> <span class="id">/</span> <span class="id">eps</span>).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">Pr_bd</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">mulR1</span> <span class="id">mu</span>) <span class="id">-</span>(<span class="id">@Ind_one</span> <span class="id">U</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">2!cEx_ExInd</span> <span class="id">-addR_opp</span> <span class="id">-mulNR</span> <span class="id">mulRA</span> <span class="id">-</span>(<span class="id">I_double</span> <span class="id">P</span>) <span class="id">-mulRDl</span> <span class="id">big_distrr</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Ex</span> <span class="id">-big_split</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrbool.html#10dd1f0b03819efd5777bd139f7faec4">/=</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="robustmean.robustmean.html#i:207">`|X</a></span> <span class="id">*/</span> <span class="id">_|]</span>(<span class="id">_</span> <span class="id">:</span> <span class="id">_</span> <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">U</span>) (<span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3e57074ab0a6a36b253e873a1bdac6ad">i</a></span> <span class="id">-</span> <span class="id">mu</span>) <span class="id">*</span> <span class="id">@Ind</span> <span class="id">U</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">i</span> <span class="id">*</span> <span class="id">P</span> <span class="id">i</span>)<span class="id">;</span> <span class="id">last</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">first</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mul0R">-mulRA</a></span> <span class="id">mulNR</span> <span class="id">addR_opp</span> <span class="id">-mulRBl</span> <span class="id">mulRA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normRM</span> (<span class="id">geR0_norm</span> (<span class="id">/</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">exact/ltRW/invR_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/leR_pdivr_mulr</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply:</span> (<span class="id">leR_trans</span> (<span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ind">leR_sumR_Rabs</a></span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">_</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">bigID</span> <span class="id">[pred</span> <span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">|</a></span> <span class="id">i</span> <span class="id">\in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">bad</a></span> <span class="id">:\:</span> <span class="id">drop]</span>) <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id">+</span> <span class="id">X]big1</span> <span class="id">?addR0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">u</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negP">/negbTE</a></span> <span class="id">abaddrop;</span> <span class="id">rewrite</span> <span class="id">/Ind</span> <span class="id">abaddrop</span> <span class="id">mulR0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">mul0R</a></span> <span class="id">normR0</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#b5b2e79e9aa4d1421d843544332af584">rewrite</a></span> <span class="id">/Pr</span> <span class="id">big_distrr</span> <span class="id">/=</span>. <span class="id">apply</span> <span class="id">leR_sumR</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">ibaddrop</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normRM</span> (<span class="id">geR0_norm</span> (<span class="id">P</span> <span class="id">i</span>))<span class="id">//;</span> <span class="id">apply:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_subl_addr">leR_wpmul2r</a></span> <span class="id">=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#leR_addl">//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Ind</span> <span class="id">ibaddrop</span> <span class="id">mulR1</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> <span class="id">ibaddrop;</span> <span class="id">rewrite</span> <span class="id">inE</span> <span class="id">=&gt;</span> <span class="id">/andP[idrop</span> <span class="id">ibad]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">rewrite</a></span> <span class="id">leRNgt</span> <span class="id">=&gt;</span> <span class="id">/Hquantile_drop_bad</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">=&gt;</a></span> <span class="id">/</span>(<span class="id">_</span> <span class="id">ibad</span>)<span class="id">;</span> <span class="id">apply/negP</span>.<br/>
<span class="id">have</span> <span class="id">max_bad_remain</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.P">:</a></span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">drop</a></span>) <span class="id">&lt;=</span> <span class="id">eps</span> <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Pr_of_cplt</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">Hdrop_ratio</a></span> <span class="id">Pr_diff</span> <span class="id">Hbad_ratio</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@leR_trans</span> <span class="id">eps</span>)<span class="id">;</span> <span class="id">first</span> <span class="id">exact/leR_subl_addr/leR_addl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/leR_pdivl_mulr;</span> <span class="id">[lra|nra]</span>.<br/>
<span class="id">have</span> <span class="id">Ex_not_drop</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#setUCr">:</a></span> <span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">~:</span> <span class="id">drop</span> <span class="id">]</span> <span class="id">=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">]</span> <span class="id">*</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_opp">:\:</a></span> <span class="id">drop</span>) <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`E_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subR_eq">bad</a></span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">]</span> <span class="id">*</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#subRR">Pr</a></span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">good_bad</span> <span class="id">:</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">+</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">=</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">_</span> <span class="id">:</span> <span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">:|:</span> <span class="id">bad</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqP">:\:</a></span> <span class="id">drop</span> <span class="id">=</span> <span class="id">~:</span> <span class="id">drop</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-setDUl</span> <span class="id">setUCr</span> <span class="id">setTD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Pr_union_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/subR_eq;</span> <span class="id">rewrite</span> <span class="id">subR_opp</span> <span class="id">addRC;</span> <span class="id">apply/esym/subR_eq;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">rewrite</a></span> <span class="id">subRR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">suff</span> <span class="id">:</span> (<span class="id">good</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id">:&amp;:</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>) <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_diff">=</a></span> <span class="id">set0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">Pr_set0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!setDE</span> <span class="id">setIACA</span> <span class="id">setIid</span> <span class="id">setICr</span> <span class="id">set0I</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#ambient_dist">[bd0|/eqP</a></span> <span class="id">bd0</span> <span class="id">{good_bad}]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>)) <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">bd0</span> <span class="id">addR0</span> <span class="gallina-kwd">in</span> <span class="id">good_bad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">bd0</span> <span class="id">mulR0</span> <span class="id">addR0</span> <span class="id"><a href="robustmean.robustmean.html#robustmean.P">good_bad</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Rdiv</span> <span class="id">-mulRA</span> <span class="id">mulRV</span> <span class="id">?mulR1;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/Pr_gt0;</span> <span class="id">rewrite</span> <span class="id">-good_bad</span> <span class="id">Pr_diff</span> <span class="id">H;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">2!cEx_ExInd</span> <span class="id">good_bad;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">/</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/eq_bigr</span> <span class="id">=&gt;</span> <span class="id">u</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/ambient_dist</span> <span class="id">-!mulRA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NB:&nbsp;lemma?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Ind</span> <span class="id">!inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">have</span> <span class="id">bad_drop0</span> <span class="id">:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">u</a></span> <span class="id">\in</span> <span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span> <span class="id">-&gt;</span> <span class="id">P</span> <span class="id">u</span> <span class="id">=</span> <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR1">Pr_set0P</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Ex">idrop</a></span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">igood;</span> <span class="id">rewrite</span> <span class="id">bad_drop0</span> <span class="id">?mulR0//</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">!inE</a></span> <span class="id">idrop</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply/eqR_divl_mulr;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Pr_of_cplt;</span> <span class="id">apply/eqP;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">rewrite</a></span> <span class="id">!cEx_ExInd</span> <span class="id">-!mulRA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#add0R">Rinv_l</a></span> <span class="id">?mulR1;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">rewrite</a></span> <span class="id">Pr_of_cplt;</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#add0R">rewrite</a></span> <span class="id">Rinv_l</span> <span class="id">?mulR1;</span> <span class="id">last</span> <span class="id">nra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Rinv_l</span> <span class="id">//</span> <span class="id">mulR1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#3942bfc45fbeaeee49010b741755982b">[in</a></span> <span class="id">RHS]/Ex</span> <span class="id">-big_split;</span> <span class="id">apply:</span> <span class="id">eq_bigr</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/ambient_dist</span> <span class="id">-!mulRA</span> <span class="id">-mulRDr</span> <span class="id">-mulRDl</span> <span class="id">;</span> <span class="id">congr</span> (<span class="id">X</span> <span class="id">i</span> <span class="id">*</span> (<span class="id">_</span> <span class="id">*</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;NB:&nbsp;lemma?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/Ind</span> <span class="id">!inE;</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#fbc8212ffd5606b6d221ca2062136a11">//=;</a></span> <span class="id">rewrite</span> <span class="id">?</span>(<span class="id">addR0,add0R</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">ifPn</span> <span class="id">=&gt;</span> <span class="id">//=;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">rewrite</a></span> <span class="id">?</span>(<span class="id">addR0,add0R</span>).<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">mulR1</span> <span class="id">mu</span>).<br/>
<span class="id">rewrite</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">1</span> <span class="id">=</span> <span class="id">eps'</span> <span class="id">+</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">good</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRDl">:\:</a></span> <span class="id">drop</span>) <span class="id">/</span> <span class="id">Pr</span> <span class="id">P</span> (<span class="id">~:</span> <span class="id">drop</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Hcompl</span> <span class="id">addRCA</span> <span class="id">addR_opp</span> <span class="id">subRR</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rbasic_fun.html#Rabs_triang">addR0</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">mulRDr</span> <span class="id">mu</span>) <span class="id">-addR_opp</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#geR0_norm">oppRD</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/mu_hat</span> <span class="id">Ex_not_drop</span> <span class="id">divRDl</span>.<br/>
<span class="id">rewrite</span> <span class="id">{2}/Rdiv</span> <span class="id">-</span>(<span class="id">mulRA</span> <span class="id">`E_[X</span> <span class="id">|</span> <span class="id">_]</span>) <span class="id">-divRE</span> <span class="id">-/eps'</span>.<br/>
<span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">rewrite</a></span> <span class="id">Hcompl</span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}/Rdiv</span> <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt">mulRA</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">`E_[X</a></span> <span class="id"><a href="robustmean.robustmean.html#964c18c6c61b25178ae33d781785d0c7">|</a></span> <span class="id">_]</span>) <span class="id">-divRE</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hcompl</span>.<br/>
<span class="id">rewrite</span> <span class="id">-addRA</span> <span class="id">addRC</span> <span class="id">addRA</span> <span class="id">-!mulNR</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqP">-</a></span>(<span class="id">mulRDl</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqVneq">eps'</a></span>).<br/>
<span class="id">rewrite</span> <span class="id">-addRA</span> <span class="id">-mulRDl</span>.<br/>
<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079">rewrite</a></span> (<span class="id">addRC</span> (<span class="id">-mu</span>)).<br/>
<span class="id">apply:</span> (<span class="id">leR_trans</span> (<span class="id">Rabs_triang</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqVneq">_</a></span> <span class="id">_</span>)).<br/>
<span class="id">rewrite</span> <span class="id">2!normRM</span> (<span class="id">geR0_norm</span> <span class="id">eps'</span>)<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#addR0">;</a></span> <span class="id">last</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> (<span class="id">geR0_norm</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps'</span>))<span class="id">;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.probability.proba#Pr_gt0">last</a></span> <span class="id">lra</span>.<br/>
<span class="id">apply:</span> (<span class="id">@leR_trans</span> (<span class="id">sqrt</span> (<span class="id">`V_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">good]</span> <span class="id">/</span> <span class="id">eps</span>) <span class="id">*</span> <span class="id">eps'</span> <span class="id">+</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sqrt</span> (<span class="id">`V_[</span> <span class="id">X</span> <span class="id">|</span> <span class="id">good]</span> <span class="id">*</span> <span class="id">2</span> <span class="id">*</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">delta</span>) <span class="id">/</span> <span class="id">delta</span>) <span class="id">*</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#160b1f5d5c3e3c6d274924649d717d8d">1</a></span> <span class="id">-</span> <span class="id">eps'</span>))).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[-&gt;|/eqP</span> <span class="id">eps'0]</span> <span class="id">:=</span> <span class="id">eqVneq</span> <span class="id">eps'</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id">mulR0,add0R,subR0,mulR1</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[-&gt;|/eqP</span> <span class="id">eps'1]</span> <span class="id">:=</span> <span class="id">eqVneq</span> <span class="id">eps'</span> <span class="id">1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!</span>(<span class="id">subRR,mulR0,addR0,mulR1</span>)<span class="id">;</span> <span class="id">apply:</span> <span class="id">Exbad_bound</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Pr_gt0;</span> <span class="id">apply:</span> <span class="id">contra_notN</span> <span class="id">eps'0</span> <span class="id">=&gt;</span> <span class="id">/eqP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/eps'</span> <span class="id">=&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">div0R</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[bd0|bd0]</span> <span class="id">:=</span> <span class="id">eqVneq</span> (<span class="id">Pr</span> <span class="id">P</span> (<span class="id">bad</span> <span class="id">:\:</span> <span class="id">drop</span>)) <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">exfalso;</span> <span class="id">apply/eps'0;</span> <span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulR_ge0">/eps'</a></span> <span class="id">bd0</span> <span class="id">div0R</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id">leR_add;</span> (<span class="id">apply/leR_pmul2r;</span> <span class="id">first</span> <span class="id">lra</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact/Exbad_bound/Pr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id">Exgood_bound</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#ltRW">/sigma</a></span> <span class="id">/Rdiv</span> <span class="id">!sqrt_mult</span> <span class="id">//;</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">last</a></span> <span class="id">8</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">cvariance_nonneg;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_mult">[apply:</a></span> <span class="id">cvariance_nonneg;</span> <span class="id">lra|lra]</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqrt.html#sqrt_mult">-</a></span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[|lra]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[apply:</span> <span class="id">cvariance_nonneg;</span> <span class="id">lra|lra]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/ltRW/invR_gt0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">cvariance_nonneg;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/ltRW/invR_gt0;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> (<span class="id">mulRC</span> <span class="id">8</span>) <span class="id">-!mulRA</span> <span class="id">-mulRDr;</span> <span class="id">apply:</span> <span class="id">leR_wpmul2l;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">sqrt_pos</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRA</span> <span class="id">-sqrt_mult;</span> <span class="id">[|lra|lra]</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulRA</span> <span class="id">-sqrt_mult;</span> <span class="id">[|lra|];</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">apply/ltRW/invR_gt0;</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">addRC;</span> <span class="id">apply/leR_subr_addr</span>.<br/>
<span class="id">rewrite</span> <span class="id">-mulRBr</span> <span class="id">-</span>(<span class="id">sqrt_Rsqr</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps'</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id">sqrt_Rsqr</span> (<span class="id">8</span> <span class="id">-</span> <span class="id">eps'</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
<span class="id">rewrite</span> <span class="id">-sqrt_mult;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRC">-</a></span> <span class="gallina-kwd">by</span> <span class="id">apply/mulR_ge0;</span> <span class="id">[lra|apply/ltRW/invR_gt0;</span> <span class="id">lra]</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id">Rle_0_sqr</span>.<br/>
<span class="id">rewrite</span> <span class="id">-sqrt_mult;</span> <span class="id">last</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">2</a></span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/ltRW/invR_gt0;</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrR#mulRA">Rle_0_sqr</a></span>.<br/>
<span class="id">apply/sqrt_le_1_alt/leR_pmul</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">mulR_ge0;</span> <span class="id">[lra|apply/ltRW/invR_gt0;</span> <span class="id">lra]</span>.<br/>
<span class="id">-</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">exact:</a></span> <span class="id">Rle_0_sqr</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-divRE;</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Reals.R_sqr.html#Rsqr_incr_1">apply/leR_pdivr_mulr;</a></span> <span class="id">first</span> <span class="id"><a href="robustmean.robustmean.html#robustmean">lra</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">mulRC</span> <span class="id">_</span> <span class="id">delta</span>) <span class="id">-divRE;</span> <span class="id">apply/leR_pdivl_mulr;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRC</span> <span class="id">mulRA;</span> <span class="id">apply/</span>(<span class="id">@leR_pmul2r</span> (<span class="id">1</span> <span class="id">-</span> <span class="id">eps</span>))<span class="id">;</span> <span class="id">first</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulRDl</span> <span class="id">mul1R</span> <span class="id">-mulNR</span> <span class="id">-</span>(<span class="id">mulRA</span> <span class="id">_</span> (<span class="id">/</span> <span class="id">_</span>)) <span class="id">Rinv_l</span> <span class="id">?mulR1;</span> <span class="id">last</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulRA</span> <span class="id">mulRDl</span> <span class="id">oppRD</span> <span class="id">oppRK</span> <span class="id">mulRDl</span> <span class="id">-</span>(<span class="id">mulRA</span> <span class="id">_</span> (<span class="id">/</span> <span class="id">_</span>)) <span class="id">Rinv_l;</span> <span class="id">[nra|lra]</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/Rsqr_incr_1;</span> <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">robustmean</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
</body>
</html>
